<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <title>Forward In Faith | Church Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
:root {
    --royal-blue: #1E2A78;           /* Royal Faith - Primary brand color */
    --deep-blue: #0B0F3B;             /* Deep Blue - Sidebar background */
    --pure-white: #FFFFFF;             /* Pure White */
    --soft-light-gray: #F4F6FA;        /* Soft Light Gray - Background */
    --gold: #D4AF37;                   /* Gold - Accent / Hover */
    --cross-red: #B11226;               /* Cross Red - Important alerts */
    
    /* Supporting shades */
    --royal-light: #2A3A9E;            /* Lighter royal blue for hover states */
    --gold-light: #E5C25C;              /* Light gold for hover effects */
    --text-dark: #1E2A3A;               /* Dark text for light backgrounds */
    --text-gray: #4A5568;                /* Gray text for secondary information */
    --border-light: #E2E8F0;             /* Light border color */
    
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    --border-radius: 8px;
}

/* Dark Mode Variables - Fixed for better contrast and harmony */
[data-theme="dark"] {
    --royal-blue: #5B6ED6;           /* Brighter royal blue for better visibility */
    --deep-blue: #12163F;             /* Slightly lighter deep blue for depth */
    --pure-white: #1E1E1E;             /* Dark background - slightly softer */
    --soft-light-gray: #2A2A2A;        /* Dark gray background - consistent */
    --gold: #F5C542;                   /* Brighter, more vibrant gold */
    --cross-red: #F56565;               /* Softer, brighter red for alerts */
    
    /* Supporting shades for dark mode - improved */
    --royal-light: #7B8CFF;            /* Even lighter royal blue for hover */
    --gold-light: #FFD966;              /* Brighter gold for hover effects */
    --text-dark: #EDF2F7;               /* Almost white for primary text */
    --text-gray: #A0AEC0;                /* Light gray for secondary text - better contrast */
    --border-light: #4A5568;             /* Medium dark border for definition */
    
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

/* Dark mode specific element overrides for consistency */
[data-theme="dark"] .sidebar {
    background-color: var(--deep-blue);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

[data-theme="dark"] .main-content {
    background-color: var(--soft-light-gray);
}

[data-theme="dark"] .card,
[data-theme="dark"] .stat-card,
[data-theme="dark"] .member-profile-header,
[data-theme="dark"] .member-profile-details,
[data-theme="dark"] .member-profile-documents,
[data-theme="dark"] .member-profiles-sidebar,
[data-theme="dark"] .ministry-card,
[data-theme="dark"] .quick-action,
[data-theme="dark"] .notifications-panel,
[data-theme="dark"] .modal-content {
    background-color: var(--pure-white);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] input,
[data-theme="dark"] select,
[data-theme="dark"] textarea {
    background-color: var(--soft-light-gray);
    color: var(--text-dark);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] input:focus,
[data-theme="dark"] select:focus,
[data-theme="dark"] textarea:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 3px rgba(245, 197, 66, 0.25);
}

[data-theme="dark"] .data-table th {
    background-color: var(--soft-light-gray);
    color: var(--text-dark);
}

[data-theme="dark"] .data-table td {
    border-bottom: 1px solid var(--border-light);
    color: var(--text-gray);
}

[data-theme="dark"] .data-table tr:hover {
    background-color: rgba(245, 197, 66, 0.1);
}

[data-theme="dark"] .nav-item {
    color: rgba(255, 255, 255, 0.8);
}

[data-theme="dark"] .nav-item:hover {
    background-color: rgba(245, 197, 66, 0.2);
    color: var(--gold-light);
}

[data-theme="dark"] .nav-item.active {
    background: linear-gradient(90deg, rgba(245, 197, 66, 0.25), transparent);
    color: var(--gold-light);
}

[data-theme="dark"] .user-info {
    background-color: rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .notification-item {
    background-color: var(--soft-light-gray);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] .member-card {
    background-color: var(--soft-light-gray);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] .member-card:hover {
    border-color: var(--gold);
}

[data-theme="dark"] .calendar-day {
    background-color: var(--soft-light-gray);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] .tab {
    background-color: var(--pure-white);
    color: var(--text-gray);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] .tab:hover {
    background-color: var(--soft-light-gray);
    color: var(--gold);
}

[data-theme="dark"] .tab.active {
    background: linear-gradient(135deg, var(--royal-blue), #3749B3);
    color: white;
}

[data-theme="dark"] .btn-outline {
    color: var(--gold);
    border-color: var(--gold);
}

[data-theme="dark"] .btn-outline:hover {
    background-color: var(--gold);
    color: var(--deep-blue);
}

[data-theme="dark"] .header h2 {
    color: var(--text-dark);
}

[data-theme="dark"] .card-title {
    color: var(--text-dark);
}

[data-theme="dark"] .stat-info p {
    color: var(--text-gray);
}

[data-theme="dark"] .login-box {
    background: rgba(30, 30, 30, 0.95);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] .login-logo h1 {
    background: linear-gradient(135deg, var(--royal-blue), var(--gold));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

[data-theme="dark"] .login-logo p {
    color: var(--text-gray);
}

[data-theme="dark"] .login-footer {
    color: var(--text-gray);
    border-top-color: var(--border-light);
}

[data-theme="dark"] .toast {
    background-color: var(--pure-white);
    color: var(--text-dark);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] .fullscreen-btn,
[data-theme="dark"] .dark-mode-btn {
    background-color: var(--pure-white);
    color: var(--text-dark);
    border: 1px solid var(--border-light);
}

[data-theme="dark"] .fullscreen-btn:hover,
[data-theme="dark"] .dark-mode-btn:hover {
    background-color: var(--gold);
    color: var(--deep-blue);
}

[data-theme="dark"] .logout-btn {
    color: var(--text-gray);
    border-color: var(--border-light);
}

[data-theme="dark"] .logout-btn:hover {
    background-color: var(--cross-red);
    border-color: var(--cross-red);
    color: white;
}

[data-theme="dark"] .header-user-name {
    color: var(--text-dark);
}

[data-theme="dark"] .header-user-role {
    color: var(--text-gray);
}

[data-theme="dark"] .notifications-btn {
    color: var(--text-gray);
}

[data-theme="dark"] .notifications-btn:hover {
    background-color: var(--pure-white);
    color: var(--gold);
}

[data-theme="dark"] .document-item {
    background-color: var(--soft-light-gray);
}

[data-theme="dark"] .member-detail-label {
    color: var(--text-gray);
}

[data-theme="dark"] .member-detail-value {
    color: var(--text-dark);
}

[data-theme="dark"] .ministry-filter-item:hover {
    background-color: var(--soft-light-gray);
}

[data-theme="dark"] .ministry-filter-item.active {
    background-color: var(--soft-light-gray);
}

[data-theme="dark"] ::placeholder {
    color: var(--text-gray);
    opacity: 0.7;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
}

body {
    background-color: var(--soft-light-gray);
    color: var(--text-dark);
    line-height: 1.6;
    min-height: 100vh;
    overflow-x: hidden;
    transition: background-color 0.3s ease, color 0.3s ease;
    -webkit-tap-highlight-color: transparent;
}

/* Loading Screen */
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--deep-blue), #050724);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    transition: opacity 0.5s ease;
}

.loading-screen.hidden {
    opacity: 0;
    pointer-events: none;
}

.loader {
    text-align: center;
    padding: 20px;
    width: 100%;
    max-width: 400px;
}

.loader-spinner {
    width: 80px;
    height: 80px;
    border: 5px solid rgba(212, 175, 55, 0.2);
    border-top-color: var(--gold);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 30px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loader h2 {
    color: var(--gold);
    margin-bottom: 15px;
    font-size: 1.8rem;
}

.loader p {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 25px;
}

/* Fullscreen button */
.fullscreen-btn {
    background-color: var(--pure-white);
    color: var(--royal-blue);
    border: 1px solid var(--border-light);
    padding: 10px 15px;
    border-radius: var(--border-radius);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s;
    box-shadow: var(--shadow);
}

.fullscreen-btn:hover {
    background-color: var(--gold);
    color: var(--deep-blue);
    border-color: var(--gold);
}

/* Dark Mode Button */
.dark-mode-btn {
    background-color: var(--pure-white);
    color: var(--royal-blue);
    border: 1px solid var(--border-light);
    padding: 10px 15px;
    border-radius: var(--border-radius);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s;
    box-shadow: var(--shadow);
}

.dark-mode-btn:hover {
    background-color: var(--gold);
    color: var(--deep-blue);
    border-color: var(--gold);
}

/* Login Screen Styles */
.login-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    align-items: center;
    min-height: 100vh;
    background: linear-gradient(135deg, var(--deep-blue), #050724);
    padding: 0;
    position: relative;
    overflow: hidden;
}

.login-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(212, 175, 55, 0.05) 0%, transparent 50%);
}

.login-box {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 20px;
    padding: 60px 48px;
    width: 90%;
    max-width: none;
    height: 90vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    box-shadow: 0 20px 60px rgba(30,42,120,0.15);
    border: 1px solid rgba(255, 255, 255, 0.25);
    position: relative;
    z-index: 1;
    grid-column: 2;
    margin: auto;
}

/* Background bouncing logo */
.login-container::after {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 50%;
    height: 100%;
    background-image: url('visionaries.png');
    background-repeat: no-repeat;
    background-position: center;
    background-size: 100%;
    opacity: 0.15;
    filter: drop-shadow(0 0 10px rgba(212,175,55,0.3));
    z-index: 0;
    animation: electricPulse 2.5s ease-in-out infinite;
    pointer-events: none;
}

@keyframes bounce {
    0% { transform: translateY(-48%) scale(0.98) rotate(-1deg); }
    25% { transform: translateY(-52%) scale(1.02) rotate(1deg); }
    50% { transform: translateY(-48%) scale(1) rotate(-1deg); }
    75% { transform: translateY(-52%) scale(1.01) rotate(1deg); }
    100% { transform: translateY(-48%) scale(0.98) rotate(-1deg); }
}

@keyframes float {
    0%, 100% { transform: translateY(-50px) scale(1); }
    50% { transform: translateY(-30px) scale(1.05); }
}

@keyframes rotateSlow {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes pulse {
    0%, 100% { opacity: 0.15; }
    50% { opacity: 0.25; }
}

@keyframes shimmer {
    0% { filter: drop-shadow(0 12px 30px rgba(0,0,0,0.35)); }
    50% { filter: drop-shadow(0 12px 40px rgba(212,175,55,0.3)); }
    100% { filter: drop-shadow(0 12px 30px rgba(0,0,0,0.35)); }
}

@keyframes electricPulse {
    0% {
        filter: drop-shadow(0 0 5px rgba(255,255,255,0.3)) drop-shadow(0 0 10px rgba(255,255,255,0.2));
        opacity: 0.12;
    }
    25% {
        filter: drop-shadow(0 0 15px rgba(255,255,255,0.6)) drop-shadow(0 0 25px rgba(255,255,255,0.4)) drop-shadow(0 0 35px rgba(255,255,255,0.2));
        opacity: 0.25;
    }
    50% {
        filter: drop-shadow(0 0 5px rgba(255,255,255,0.3)) drop-shadow(0 0 10px rgba(255,255,255,0.2));
        opacity: 0.15;
    }
    75% {
        filter: drop-shadow(0 0 20px rgba(255,255,255,0.7)) drop-shadow(0 0 30px rgba(255,255,255,0.5)) drop-shadow(0 0 40px rgba(255,255,255,0.3));
        opacity: 0.28;
    }
    100% {
        filter: drop-shadow(0 0 5px rgba(255,255,255,0.3)) drop-shadow(0 0 10px rgba(255,255,255,0.2));
        opacity: 0.12;
    }
}

@media (max-width: 900px) {
    .login-container::after { display: none; }
    .login-container { justify-content: center; padding: 30px; }
    .login-box { max-width: 520px; }
}

.login-logo {
    text-align: center;
    margin-bottom: 48px;
}

.login-logo h1 {
    color: var(--royal-blue);
    font-size: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 12px;
    font-weight: 900;
    letter-spacing: -1px;
    background: linear-gradient(135deg, var(--royal-blue), var(--gold));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.login-logo p {
    color: var(--text-gray);
    font-size: 1rem;
    font-weight: 500;
    letter-spacing: 0.5px;
}

.church-badge {
    background: linear-gradient(90deg, var(--gold), var(--royal-blue));
    height: 4px;
    margin: 5px 0;
    border-radius: 2px;
}

.login-form .form-group {
    margin-bottom: 28px;
    position: relative;
}

.login-form label {
    display: block;
    margin-bottom: 10px;
    font-weight: 600;
    color: var(--text-dark);
    font-size: 0.95rem;
    letter-spacing: 0.3px;
    text-transform: uppercase;
    opacity: 0.8;
}

.login-form input,
.login-form select {
    width: 100%;
    padding: 16px 18px;
    border-radius: 12px;
    border: 2px solid transparent;
    background: rgba(255, 255, 255, 0.85);
    color: var(--text-dark);
    font-size: 1.02rem;
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 15px rgba(30,42,120,0.08);
    backdrop-filter: blur(10px);
    font-family: 'Poppins', sans-serif;
}

.login-form input::placeholder {
    color: var(--text-gray);
    opacity: 0.7;
}

.login-form input:hover,
.login-form select:hover {
    background: rgba(255, 255, 255, 0.95);
    box-shadow: 0 8px 25px rgba(30,42,120,0.12);
}

.login-form input:focus,
.login-form select:focus {
    outline: none;
    border-color: var(--gold);
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 12px 35px rgba(212,175,55,0.25);
    transform: translateY(-2px);
}

.login-btn {
    width: 100%;
    padding: 16px 24px;
    background: linear-gradient(135deg, var(--royal-blue) 0%, var(--royal-light) 100%);
    color: var(--pure-white);
    border: none;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    letter-spacing: 1px;
    box-shadow: 0 8px 25px rgba(30,42,120,0.25);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    margin-top: 20px;
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    font-size: 1rem;
}

.login-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 15px 40px rgba(30, 42, 120, 0.4);
    background: linear-gradient(135deg, var(--royal-light), var(--gold));
}

.login-btn:active {
    transform: translateY(-1px);
    box-shadow: 0 6px 20px rgba(30, 42, 120, 0.3);
}

.login-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.login-btn:active::before {
    width: 300px;
    height: 300px;
}

.login-footer {
    text-align: center;
    margin-top: 40px;
    padding-top: 30px;
    border-top: 2px solid var(--border-light);
    color: var(--text-gray);
    font-size: 0.85rem;
    font-weight: 500;
    letter-spacing: 0.5px;
}

.login-footer p {
    margin: 4px 0;
}

.role-badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
}

.role-pastor {
    background-color: rgba(30, 42, 120, 0.1);
    color: var(--royal-blue);
}

.role-elder {
    background-color: rgba(212, 175, 55, 0.1);
    color: var(--gold);
}

.role-deacon {
    background-color: rgba(177, 18, 38, 0.1);
    color: var(--cross-red);
}

.role-volunteer {
    background-color: rgba(30, 42, 120, 0.05);
    color: var(--royal-blue);
}

.role-member {
    background-color: rgba(74, 85, 104, 0.1);
    color: var(--text-gray);
}

/* App Container (Initially Hidden) */
.app-container {
    display: none;
    min-height: 100vh;
}

/* Sidebar */
.sidebar {
    width: 250px;
    background-color: var(--deep-blue);
    padding: 20px 0;
    display: flex;
    flex-direction: column;
    transition: all 0.3s;
    box-shadow: var(--shadow);
    z-index: 100;
    position: relative;
}

.sidebar::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--gold), var(--royal-blue));
    box-shadow: 0 4px 16px rgba(212,175,55,0.13);
}

.logo {
    padding: 0 20px 20px;
    border-bottom: 2px solid var(--gold);
    margin-bottom: 20px;
}

.logo h1 {
    color: var(--pure-white);
    font-size: 1.6rem;
    display: flex;
    align-items: center;
    font-weight: 700;
}

.logo h1 i {
    margin-right: 10px;
    color: var(--gold);
}

.logo p {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.7);
    margin-top: 5px;
}

.nav-menu {
    flex: 1;
    padding: 0 15px;
}

.nav-item {
    display: flex;
    align-items: center;
    padding: 15px;
    margin-bottom: 8px;
    border-radius: var(--border-radius);
    color: rgba(255, 255, 255, 0.7);
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
}

.nav-item:hover {
    background-color: rgba(212, 175, 55, 0.15);
    color: var(--gold);
}

.nav-item.active {
    background: linear-gradient(90deg, rgba(212, 175, 55, 0.2), transparent);
    color: var(--gold);
    border-left: 4px solid var(--gold);
}

.nav-item i {
    margin-right: 12px;
    font-size: 1.2rem;
}

.notification-badge {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    background-color: var(--cross-red);
    color: white;
    font-size: 0.7rem;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
}

.user-info {
    padding: 20px;
    border-top: 1px solid rgba(212, 175, 55, 0.3);
    display: flex;
    align-items: center;
    background-color: rgba(0, 0, 0, 0.2);
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--gold), var(--royal-blue));
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 12px;
    font-weight: bold;
    font-size: 1.2rem;
    color: var(--deep-blue);
    box-shadow: 0 2px 8px rgba(212, 175, 55, 0.3);
}

.user-details {
    flex: 1;
}

.user-name {
    font-weight: 500;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    color: var(--pure-white);
}

.user-role {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.6);
}

/* Main Content Styles */
.main-content {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    background-color: var(--soft-light-gray);
    position: relative;
}

.main-content::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 10% 20%, rgba(30, 42, 120, 0.02) 0%, transparent 50%),
        radial-gradient(circle at 90% 80%, rgba(212, 175, 55, 0.02) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-light);
    position: relative;
    z-index: 1;
}

.header h2 {
    color: var(--deep-blue);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.header h2 i {
    color: var(--gold);
}

.header-user {
    display: flex;
    align-items: center;
    gap: 15px;
}

.header-user-info {
    text-align: right;
}

.header-user-name {
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 8px;
    color: var(--text-dark);
}

.header-user-role {
    font-size: 0.85rem;
    color: var(--text-gray);
}

.notifications-container {
    position: relative;
}

.notifications-btn {
    background: none;
    border: none;
    color: var(--text-gray);
    font-size: 1.2rem;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: all 0.3s;
    position: relative;
}

.notifications-btn:hover {
    background-color: var(--pure-white);
    color: var(--gold);
}

.notifications-count {
    position: absolute;
    top: -5px;
    right: -5px;
    background-color: var(--cross-red);
    color: white;
    font-size: 0.7rem;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
}

.logout-btn {
    background: none;
    border: 1px solid var(--border-light);
    color: var(--text-gray);
    padding: 8px 16px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 6px;
}

.logout-btn:hover {
    background-color: var(--cross-red);
    border-color: var(--cross-red);
    color: white;
}

.header-actions {
    display: flex;
    gap: 15px;
    align-items: center;
}

.btn {
    padding: 10px 20px;
    border-radius: var(--border-radius);
    border: none;
    cursor: pointer;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    gap: 8px;
}

.btn i {
    font-size: 1rem;
}

.btn-primary {
    background: linear-gradient(135deg, var(--royal-blue), var(--deep-blue));
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(30, 42, 120, 0.3);
    background: linear-gradient(135deg, var(--royal-light), var(--royal-blue));
}

.btn-success {
    background: linear-gradient(135deg, #059669, #047857);
    color: white;
}

.btn-success:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(5, 150, 105, 0.3);
}

.btn-warning {
    background: linear-gradient(135deg, #F59E0B, #D97706);
    color: white;
}

.btn-warning:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(245, 158, 11, 0.3);
}

.btn-danger {
    background: linear-gradient(135deg, var(--cross-red), #991b1b);
    color: white;
}

.btn-danger:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(177, 18, 38, 0.4);
}

.btn-outline {
    background-color: transparent;
    color: var(--royal-blue);
    border: 2px solid var(--royal-blue);
}

.btn-outline:hover {
    background-color: var(--royal-blue);
    color: white;
    transform: translateY(-2px);
}

.btn-sm {
    padding: 5px 12px;
    font-size: 0.875rem;
}

/* Dashboard Styles */
.dashboard-overview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    padding: 20px;
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    border-left: 4px solid var(--gold);
    position: relative;
    overflow: hidden;
    transition: all 0.3s;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.stat-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(30, 42, 120, 0.1), transparent);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
}

.stat-icon i {
    font-size: 1.8rem;
    color: var(--royal-blue);
}

.stat-info h3 {
    font-size: 1.8rem;
    margin-bottom: 5px;
    background: linear-gradient(90deg, var(--royal-blue), var(--gold));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.stat-info p {
    color: var(--text-gray);
    font-size: 0.9rem;
}

.stat-trend {
    position: absolute;
    top: 15px;
    right: 15px;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 4px;
}

.trend-up {
    color: #059669;
}

.trend-down {
    color: var(--cross-red);
}

.dashboard-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 30px;
    margin-bottom: 30px;
}

@media (max-width: 1100px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
}

.card {
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    padding: 25px;
    box-shadow: var(--shadow);
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--gold), var(--royal-blue));
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-light);
}

.card-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--deep-blue);
}

.card-title i {
    color: var(--gold);
    margin-right: 10px;
}

/* Notifications Panel */
.notifications-panel {
    position: fixed;
    top: 0;
    right: -400px;
    width: 400px;
    height: 100vh;
    background-color: var(--pure-white);
    box-shadow: -5px 0 25px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    transition: right 0.3s ease;
    display: flex;
    flex-direction: column;
}

.notifications-panel.active {
    right: 0;
}

.notifications-header {
    padding: 20px;
    border-bottom: 1px solid var(--border-light);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, var(--royal-blue), var(--deep-blue));
}

.notifications-header h3 {
    color: var(--pure-white);
    font-size: 1.2rem;
}

.notifications-header h3 i {
    color: var(--gold);
    margin-right: 10px;
}

.close-notifications {
    background: none;
    border: none;
    color: var(--pure-white);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 5px;
}

.close-notifications:hover {
    color: var(--gold);
}

.notifications-list {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

.notification-item {
    background-color: var(--soft-light-gray);
    border-radius: var(--border-radius);
    padding: 15px;
    margin-bottom: 15px;
    border-left: 4px solid var(--gold);
    transition: all 0.3s;
}

.notification-item:hover {
    transform: translateX(-5px);
    box-shadow: var(--shadow);
}

.notification-item.unread {
    border-left-color: var(--cross-red);
    background-color: rgba(177, 18, 38, 0.05);
}

.notification-title {
    font-weight: 600;
    margin-bottom: 5px;
    color: var(--text-dark);
}

.notification-message {
    font-size: 0.9rem;
    color: var(--text-gray);
    margin-bottom: 10px;
}

.notification-time {
    font-size: 0.8rem;
    color: var(--text-gray);
    display: flex;
    align-items: center;
    gap: 5px;
}

.notification-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.notification-type {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
    margin-bottom: 5px;
}

.type-birthday {
    background-color: rgba(212, 175, 55, 0.1);
    color: var(--gold);
}

.type-event {
    background-color: rgba(30, 42, 120, 0.1);
    color: var(--royal-blue);
}

.type-prayer {
    background-color: rgba(177, 18, 38, 0.1);
    color: var(--cross-red);
}

.type-donation {
    background-color: rgba(5, 150, 105, 0.1);
    color: #059669;
}

/* Table Styles */
.table-responsive {
    overflow-x: auto;
    border-radius: var(--border-radius);
    border: 1px solid var(--border-light);
}

.data-table {
    width: 100%;
    border-collapse: collapse;
}

.data-table th {
    text-align: left;
    padding: 15px;
    background-color: var(--soft-light-gray);
    color: var(--deep-blue);
    font-weight: 600;
    border-bottom: 2px solid var(--gold);
}

.data-table td {
    padding: 15px;
    border-bottom: 1px solid var(--border-light);
}

.data-table tr:hover {
    background-color: rgba(212, 175, 55, 0.05);
}

.status-badge {
    display: inline-block;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
}

.status-active {
    background-color: rgba(5, 150, 105, 0.1);
    color: #059669;
}

.status-pending {
    background-color: rgba(245, 158, 11, 0.1);
    color: #F59E0B;
}

.status-completed {
    background-color: rgba(30, 42, 120, 0.1);
    color: var(--royal-blue);
}

.status-overdue {
    background-color: rgba(177, 18, 38, 0.1);
    color: var(--cross-red);
}

.status-inactive {
    background-color: rgba(74, 85, 104, 0.1);
    color: var(--text-gray);
}

/* Form Styles */
.form-container {
    max-width: 800px;
    margin: 0 auto;
}

.form-group {
    margin-bottom: 20px;
}

.form-row {
    display: flex;
    gap: 20px;
}

.form-row .form-group {
    flex: 1;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--text-dark);
}

input, select, textarea {
    width: 100%;
    padding: 12px 15px;
    background-color: var(--soft-light-gray);
    border: 1px solid var(--border-light);
    border-radius: var(--border-radius);
    color: var(--text-dark);
    font-size: 1rem;
    transition: all 0.3s;
}

input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--gold);
    box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
}

/* Quick Actions */
.quick-actions {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 30px;
}

.quick-action {
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    border: 1px solid transparent;
    box-shadow: var(--shadow);
}

.quick-action:hover {
    border-color: var(--gold);
    transform: translateY(-5px);
    background-color: rgba(212, 175, 55, 0.05);
}

.quick-action i {
    font-size: 2rem;
    color: var(--gold);
    margin-bottom: 10px;
}

.quick-action span {
    display: block;
    font-weight: 500;
    color: var(--text-dark);
}

/* Toast Notifications */
#toast-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 10000;
}

.toast {
    background-color: var(--pure-white);
    color: var(--text-dark);
    padding: 15px 20px;
    border-radius: var(--border-radius);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
    max-width: 400px;
    animation: slideIn 0.3s ease;
    border-left: 4px solid var(--gold);
}

.toast.error {
    border-left-color: var(--cross-red);
}

.toast.warning {
    border-left-color: #F59E0B;
}

.toast.success {
    border-left-color: #059669;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.toast i {
    font-size: 1.2rem;
}

.toast.success i {
    color: #059669;
}

.toast.error i {
    color: var(--cross-red);
}

.toast.warning i {
    color: #F59E0B;
}

/* Section visibility */
.section {
    display: none;
    position: relative;
    z-index: 1;
}

.section.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Member Profile Styles */
.member-profiles-container {
    display: flex;
    gap: 30px;
}

.member-profiles-sidebar {
    width: 300px;
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    padding: 20px;
    height: fit-content;
    box-shadow: var(--shadow);
}

.member-profiles-content {
    flex: 1;
}

.ministry-filter {
    margin-bottom: 20px;
}

.ministry-filter h4 {
    margin-bottom: 10px;
    color: var(--deep-blue);
}

.ministry-filter-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.ministry-filter-item {
    display: flex;
    align-items: center;
    padding: 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all 0.3s;
}

.ministry-filter-item:hover {
    background-color: var(--soft-light-gray);
}

.ministry-filter-item.active {
    background-color: var(--soft-light-gray);
    border-left: 4px solid var(--gold);
}

.ministry-filter-count {
    margin-left: auto;
    background-color: var(--gold);
    color: var(--deep-blue);
    width: 25px;
    height: 25px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    font-weight: 600;
}

.member-profile-header {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 30px;
    padding: 20px;
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
}

.member-profile-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--gold), var(--royal-blue));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    font-weight: bold;
    color: var(--deep-blue);
    box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
}

.member-profile-info {
    flex: 1;
}

.member-profile-name {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 5px;
    color: var(--deep-blue);
}

.member-profile-ministries {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 15px;
}

.member-profile-content {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 30px;
}

.member-profile-details {
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    padding: 25px;
    box-shadow: var(--shadow);
}

.member-profile-details-section {
    margin-bottom: 30px;
}

.member-profile-details-section h3 {
    font-size: 1.2rem;
    margin-bottom: 15px;
    color: var(--gold);
    display: flex;
    align-items: center;
    gap: 10px;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--border-light);
}

.member-profile-details-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.member-detail-item {
    margin-bottom: 15px;
}

.member-detail-label {
    font-size: 0.9rem;
    color: var(--text-gray);
    margin-bottom: 5px;
}

.member-detail-value {
    font-size: 1rem;
    color: var(--text-dark);
    font-weight: 500;
}

.member-profile-documents {
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    padding: 25px;
    box-shadow: var(--shadow);
}

.document-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.document-item {
    display: flex;
    align-items: center;
    padding: 15px;
    background-color: var(--soft-light-gray);
    border-radius: var(--border-radius);
    transition: all 0.3s;
}

.document-item:hover {
    transform: translateX(-5px);
    box-shadow: var(--shadow);
}

.document-icon {
    width: 50px;
    height: 50px;
    border-radius: 10px;
    background: linear-gradient(135deg, var(--gold), var(--royal-blue));
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--deep-blue);
    font-size: 1.5rem;
}

.document-info {
    flex: 1;
}

.document-name {
    font-weight: 600;
    margin-bottom: 5px;
    color: var(--text-dark);
}

.document-meta {
    font-size: 0.85rem;
    color: var(--text-gray);
}

.document-actions {
    display: flex;
    gap: 10px;
}

.ministry-card {
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: var(--shadow);
    border-left: 4px solid var(--gold);
}

.ministry-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
}

.ministry-card-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--deep-blue);
    display: flex;
    align-items: center;
    gap: 10px;
}

.ministry-card-count {
    background-color: var(--gold);
    color: var(--deep-blue);
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    font-weight: 600;
}

.members-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.member-card {
    background-color: var(--soft-light-gray);
    border-radius: var(--border-radius);
    padding: 20px;
    transition: all 0.3s;
    cursor: pointer;
    border: 1px solid transparent;
}

.member-card:hover {
    border-color: var(--gold);
    transform: translateY(-5px);
    box-shadow: var(--shadow);
}

.member-card-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
}

.member-card-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--gold), var(--royal-blue));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--deep-blue);
}

.member-card-info {
    flex: 1;
}

.member-card-name {
    font-weight: 600;
    margin-bottom: 5px;
    color: var(--text-dark);
}

.member-card-role {
    font-size: 0.85rem;
    color: var(--text-gray);
}

.member-card-details {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
    font-size: 0.9rem;
    color: var(--text-gray);
}

/* Calendar Grid */
.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 5px;
    margin-top: 20px;
}

.calendar-day {
    background-color: var(--soft-light-gray);
    padding: 10px;
    border-radius: var(--border-radius);
    min-height: 100px;
    position: relative;
}

.calendar-day-header {
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--deep-blue);
    padding-bottom: 5px;
    border-bottom: 1px solid var(--border-light);
}

.calendar-event {
    background-color: rgba(30, 42, 120, 0.1);
    color: var(--royal-blue);
    padding: 3px 6px;
    border-radius: 4px;
    font-size: 0.8rem;
    margin-bottom: 3px;
    cursor: pointer;
}

.calendar-event:hover {
    background-color: rgba(30, 42, 120, 0.2);
}

.calendar-event.service {
    background-color: rgba(212, 175, 55, 0.1);
    color: var(--gold);
}

.calendar-event.prayer {
    background-color: rgba(177, 18, 38, 0.1);
    color: var(--cross-red);
}


/* Modal */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(5px);
}

.modal.active {
    display: flex;
}

.modal-content {
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    padding: 30px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    border: 1px solid var(--gold);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-light);
}

.modal-header h2 {
    color: var(--deep-blue);
}

.modal-header h2 i {
    color: var(--gold);
    margin-right: 10px;
}

.modal-close {
    background: none;
    border: none;
    color: var(--text-gray);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 5px;
}

.modal-close:hover {
    color: var(--cross-red);
}

/* Service Tags */
.service-tag {
    display: inline-block;
    padding: 2px 8px;
    background-color: rgba(212, 175, 55, 0.1);
    color: var(--gold);
    border-radius: 12px;
    font-size: 0.75rem;
    margin-right: 4px;
    margin-bottom: 4px;
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 40px 20px;
}

.empty-state i {
    font-size: 3rem;
    color: var(--gold);
    margin-bottom: 15px;
}

.empty-state h3 {
    color: var(--deep-blue);
    margin-bottom: 10px;
}

.empty-state p {
    color: var(--text-gray);
}

/* Reports Tabs */
.tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.tab {
    padding: 10px 20px;
    background-color: var(--pure-white);
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all 0.3s;
    color: var(--text-gray);
    border: 1px solid var(--border-light);
}

.tab:hover {
    background-color: var(--soft-light-gray);
    color: var(--gold);
}

.tab.active {
    background: linear-gradient(135deg, var(--royal-blue), var(--deep-blue));
    color: white;
    border: none;
}

.reports-tab {
    display: none;
}

.reports-tab.active {
    display: block;
}

/* Additional color utilities */
.text-gold {
    color: var(--gold);
}

.text-royal {
    color: var(--royal-blue);
}

.text-cross-red {
    color: var(--cross-red);
}

.bg-gold {
    background-color: var(--gold);
}

.bg-soft-light {
    background-color: var(--soft-light-gray);
}

/* ==================== ENHANCED MOBILE RESPONSIVENESS ==================== */

/* Mobile Menu Toggle Button */
.mobile-menu-toggle {
    display: none;
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 1000;
    background: linear-gradient(135deg, var(--royal-blue), var(--deep-blue));
    color: white;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    font-size: 1.5rem;
    cursor: pointer;
    box-shadow: var(--shadow);
    align-items: center;
    justify-content: center;
}

/* Mobile Header Actions */
.mobile-header-actions {
    display: none;
    position: fixed;
    top: 15px;
    right: 15px;
    z-index: 1000;
    gap: 10px;
}

.mobile-header-actions button {
    background: linear-gradient(135deg, var(--royal-blue), var(--deep-blue));
    color: white;
    border: none;
    border-radius: 50%;
    width: 45px;
    height: 45px;
    font-size: 1.2rem;
    cursor: pointer;
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Responsive Breakpoints */
@media (max-width: 1024px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    
    .member-profile-content {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 900px) {
    /* Sidebar transforms into overlay */
    .sidebar {
        position: fixed;
        left: -280px;
        top: 0;
        bottom: 0;
        width: 280px;
        z-index: 1001;
        transition: left 0.3s ease;
        overflow-y: auto;
    }
    
    .sidebar.mobile-open {
        left: 0;
    }
    
    /* Mobile menu toggle visible */
    .mobile-menu-toggle {
        display: flex;
    }
    
    .mobile-header-actions {
        display: flex;
    }
    
    /* Adjust main content */
    .main-content {
        margin-left: 0;
        padding: 70px 15px 20px;
    }
    
    /* Hide desktop header actions */
    .header-actions {
        display: none;
    }
    
    /* Adjust header */
    .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
        margin-top: 10px;
    }
    
    .header-user {
        width: 100%;
        justify-content: space-between;
    }
    
    /* Member profiles container */
    .member-profiles-container {
        flex-direction: column;
    }
    
    .member-profiles-sidebar {
        width: 100%;
    }
    
    /* Member profile header */
    .member-profile-header {
        flex-direction: column;
        text-align: center;
    }
    
    .member-profile-avatar {
        margin: 0 auto;
    }
    
    /* Calendar grid */
    .calendar-grid {
        font-size: 0.8rem;
    }
    
    .calendar-day {
        min-height: 60px;
        padding: 5px;
    }
    
    /* Modal */
    .modal-content {
        width: 95%;
        padding: 20px;
        margin: 10px;
        max-height: 85vh;
    }
    
    /* Login container */
    .login-container {
        grid-template-columns: 1fr;
    }
    
    .login-box {
        width: 100%;
        max-width: 100%;
        height: 100vh;
        border-radius: 0;
        padding: 40px 20px;
        margin: 0;
    }
    
    /* Tabs */
    .tabs {
        flex-wrap: wrap;
    }
    
    .tab {
        flex: 1 1 calc(50% - 5px);
        text-align: center;
        font-size: 0.9rem;
        padding: 8px 12px;
    }
    
    /* Dashboard stats */
    .dashboard-overview {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }
    
    .stat-card {
        padding: 15px;
    }
    
    .stat-icon {
        width: 50px;
        height: 50px;
        margin-right: 10px;
    }
    
    .stat-icon i {
        font-size: 1.4rem;
    }
    
    .stat-info h3 {
        font-size: 1.4rem;
    }
    
    /* Quick actions */
    .quick-actions {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }
    
    /* Notifications panel */
    .notifications-panel {
        width: 100%;
        right: -100%;
    }
    
    .notifications-panel.active {
        right: 0;
    }
}

@media (max-width: 600px) {
    /* Even smaller screens */
    .dashboard-overview {
        grid-template-columns: 1fr;
    }
    
    .quick-actions {
        grid-template-columns: 1fr;
    }
    
    /* Member cards grid */
    .members-grid {
        grid-template-columns: 1fr;
    }
    
    /* Profile details grid */
    .member-profile-details-grid {
        grid-template-columns: 1fr;
        gap: 10px;
    }
    
    /* Document item */
    .document-item {
        flex-direction: column;
        text-align: center;
    }
    
    .document-icon {
        margin-right: 0;
        margin-bottom: 10px;
    }
    
    .document-actions {
        margin-top: 10px;
    }
    
    /* Ministry card */
    .ministry-card-header {
        flex-direction: column;
        gap: 10px;
    }
    
    /* Form rows */
    .form-row {
        flex-direction: column;
        gap: 0;
    }
    
    /* Calendar */
    .calendar-grid {
        grid-template-columns: repeat(7, 1fr);
        gap: 2px;
    }
    
    .calendar-day {
        min-height: 50px;
        font-size: 0.7rem;
        padding: 3px;
    }
    
    .calendar-event {
        font-size: 0.6rem;
        padding: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    /* Toast notifications */
    #toast-container {
        left: 15px;
        right: 15px;
        bottom: 15px;
    }
    
    .toast {
        max-width: 100%;
        margin: 5px 0;
    }
    
    /* Login tabs */
    .login-tabs {
        gap: 10px;
    }
    
    .login-tab {
        font-size: 0.95rem;
        padding: 8px 12px;
    }
    
    /* Table responsiveness */
    .data-table th,
    .data-table td {
        padding: 10px 8px;
        font-size: 0.85rem;
    }
    
    /* Buttons */
    .btn {
        padding: 8px 15px;
        font-size: 0.9rem;
    }
    
    .btn-sm {
        padding: 4px 8px;
        font-size: 0.8rem;
    }
    
    /* Modal header */
    .modal-header h2 {
        font-size: 1.2rem;
    }
    
    .modal-close {
        font-size: 1.2rem;
    }
    
    /* Member card details */
    .member-card-details {
        flex-direction: column;
        gap: 5px;
        align-items: flex-start;
    }
}

@media (max-width: 380px) {
    /* Very small phones */
    .calendar-day {
        min-height: 40px;
    }
    
    .calendar-day-header {
        font-size: 0.6rem;
    }
    
    .tab {
        font-size: 0.8rem;
        padding: 6px 8px;
    }
    
    .member-profile-avatar {
        width: 70px;
        height: 70px;
        font-size: 1.8rem;
    }
    
    .member-profile-name {
        font-size: 1.4rem;
    }
}

/* Touch-friendly improvements */
@media (hover: none) and (pointer: coarse) {
    /* Larger touch targets */
    .nav-item,
    .btn,
    .tab,
    .ministry-filter-item,
    .member-card,
    .quick-action {
        min-height: 44px;
    }
    
    /* Remove hover effects on mobile */
    .btn:hover,
    .nav-item:hover,
    .member-card:hover,
    .quick-action:hover {
        transform: none;
    }
    
    /* Active states for touch */
    .btn:active,
    .nav-item:active,
    .member-card:active {
        opacity: 0.7;
        transform: scale(0.98);
    }
    
    /* Better scrolling */
    .main-content,
    .notifications-list,
    .modal-content {
        -webkit-overflow-scrolling: touch;
    }
    
    /* Form inputs */
    input, select, textarea {
        font-size: 16px; /* Prevents zoom on iOS */
    }
}

/* Overlay for mobile menu */
.mobile-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    backdrop-filter: blur(3px);
}

.mobile-overlay.active {
    display: block;
}

/* Print styles */
@media print {
    .sidebar,
    .header-actions,
    .logout-btn,
    .notifications-container,
    .fullscreen-btn,
    .dark-mode-btn,
    .quick-actions,
    .btn {
        display: none !important;
    }
    
    .main-content {
        margin: 0;
        padding: 20px;
    }
    
    .card {
        break-inside: avoid;
        box-shadow: none;
        border: 1px solid #ddd;
    }
}
</style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
        <div class="loader">
            <div class="loader-spinner"></div>
            <h2>Forward In Faith</h2>
            <p>Loading church management system...</p>
            <button class="btn btn-primary" id="enter-fullscreen-btn" style="margin-top: 20px;">
                <i class="fas fa-expand"></i> Enter Fullscreen
            </button>
        </div>
    </div>
    
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" id="mobile-menu-toggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Mobile Header Actions -->
    <div class="mobile-header-actions" id="mobile-header-actions">
        <button class="mobile-notifications-btn" id="mobile-notifications-btn">
            <i class="fas fa-bell"></i>
            <span class="notifications-count" id="mobile-notifications-count">0</span>
        </button>
        <button class="mobile-dark-mode-btn" id="mobile-dark-mode-toggle">
            <i class="fas fa-moon"></i>
        </button>
    </div>
    
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobile-overlay"></div>
    
    <!-- Login Screen (Initially Visible) -->
    <div class="login-container" id="login-container">
        <div class="login-box">
            <div class="login-logo">
                <img src="logo.png" alt="Logo" style="max-width: 100px; display: block; margin: 0 auto 10px;">
                <h1 style="margin-top: 10px;">Forward In Faith</h1>
                <p>Church Management System</p>
                <div class="church-badge"></div>
                <p style="font-size: 0.8rem; margin-top: 5px;">"Feed my sheep" - John 21:17</p>
            </div>
            <div class="login-tabs" style="display: flex; justify-content: center; gap: 18px; margin-bottom: 28px;">
                <button type="button" id="tab-signin" class="login-tab active" style="background:none;border:none;font-weight:600;font-size:1.08rem;color:var(--royal-blue);padding:8px 18px;cursor:pointer;border-bottom:3px solid var(--gold);border-radius:0;">Sign In</button>
                <button type="button" id="tab-signup" class="login-tab" style="background:none;border:none;font-weight:600;font-size:1.08rem;color:var(--text-gray);padding:8px 18px;cursor:pointer;border-bottom:3px solid transparent;border-radius:0;">Sign Up</button>
            </div>
            <form class="login-form" id="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Enter your username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter your password" required autocomplete="current-password">
                </div>
                <div class="form-group" id="signup-email-group" style="display:none;">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Enter your email" autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="role">Select Role</label>
                    <select id="role" required>
                        <option value="">Select your role</option>
                        <option value="admin">1. Church Admin</option>
                        <option value="overseer">2. Church Overseer</option>
                        <option value="pastor">3. Church Pastor</option>
                        <option value="elder">4. Church Elder</option>
                        <option value="secretary">5. Church Secretary</option>
                    </select>
                </div>
                <button type="submit" class="login-btn" id="login-btn">
                    <i class="fas fa-sign-in-alt"></i> Sign In
                </button>
            </form>
            <form class="login-form" id="signup-form" style="display:none;">
                <input type="hidden" id="signup-id">
                <div class="form-group">
                    <label for="signup-username">Username</label>
                    <input type="text" id="signup-username" placeholder="Choose a username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" placeholder="Create a password" required autocomplete="new-password">
                </div>
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" placeholder="Enter your email" required autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="signup-role">Select Role</label>
                    <select id="signup-role" required>
                        <option value="">Select your role</option>
                        <option value="admin">1. Church Admin</option>
                        <option value="overseer">2. Church Overseer</option>
                        <option value="pastor">3. Church Pastor</option>
                        <option value="elder">4. Church Elder</option>
                        <option value="secretary">5. Church Secretary</option>
                    </select>
                </div>
                <button type="submit" class="login-btn" id="signup-btn">
                    <i class="fas fa-user-plus"></i> Sign Up
                </button>
            </form>
            <div class="login-footer">
                <p> 2026 Forward In Faith Church Management System</p>
                <p>Managing God's people with love and care</p>
            </div>
        </div>
    </div>
    
    <!-- CRM Application (Initially Hidden) -->
    <div class="app-container" id="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="logo" style="display: flex; align-items: center; gap: 12px;">
                <img src="logo.png" alt="Logo" style="max-width: 48px; height: 48px; display: block; margin: 0;">
                <div>
                    <h1 style="margin: 0; font-size: 1.5rem; font-weight: 700; letter-spacing: 0.5px;">Forward In Faith</h1>
                    <p style="margin: 0; font-size: 0.95rem; color: var(--text-gray);">Church Management System</p>
                </div>
            </div>
            
            <div class="nav-menu">
                <div class="nav-item active" data-section="dashboard">
                    <span style="font-weight:600;letter-spacing:0.5px;">Dashboard</span>
                    <span class="notification-badge" id="dashboard-notifications">0</span>
                </div>
                <div class="nav-item" data-section="members">
                    <i class="fas fa-users"></i> Members
                </div>
                <div class="nav-item" data-section="member-profiles">
                    <i class="fas fa-id-card"></i> Member Profiles
                </div>
                <div class="nav-item" data-section="visitors">
                    <i class="fas fa-user-plus"></i> Visitors
                </div>
                <div class="nav-item" data-section="events">
                    <i class="fas fa-calendar-alt"></i> Church Events
                </div>
                <div class="nav-item" data-section="ministries">
                    <i class="fas fa-pray"></i> Ministries
                </div>
                <div class="nav-item" data-section="prayer">
                    <i class="fas fa-hands"></i> Prayer Requests
                </div>
                <div class="nav-item" data-section="documents">
                    <i class="fas fa-file-contract"></i> Documents
                </div>
                <div class="nav-item" data-section="calendar">
                    <i class="fas fa-calendar-alt"></i> Calendar
                </div>
                <div class="nav-item" data-section="reports">
                    <i class="fas fa-chart-bar"></i> Reports
                </div>
                <div class="nav-item" data-section="settings">
                    <i class="fas fa-cog"></i> Settings
                </div>
            </div>
            
            <div class="user-info">
                <div class="user-avatar" id="user-avatar">P</div>
                <div class="user-details">
                    <div class="user-name">
                        <span id="sidebar-user-name">Pastor Michael</span>
                        <span class="role-badge role-pastor" id="sidebar-user-role">Pastor</span>
                    </div>
                    <div class="user-role" id="sidebar-user-full-role">Senior Pastor</div>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <h2 id="page-title" style="font-weight:700;letter-spacing:0.5px;">Dashboard</h2>
                <div class="header-actions">
                    <div class="notifications-container">
                        <button class="notifications-btn" id="notifications-btn">
                            <i class="fas fa-bell"></i>
                            <span class="notifications-count" id="notifications-count">0</span>
                        </button>
                    </div>
                    <div class="header-user">
                        <div class="header-user-info">
                            <div class="header-user-name">
                                <span id="header-user-name">Pastor Michael</span>
                                <span class="role-badge role-pastor" id="header-user-role">Pastor</span>
                            </div>
                            <div class="header-user-role" id="header-user-full-role">Senior Pastor</div>
                        </div>
                        <button class="logout-btn" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                    <button class="btn btn-primary" id="add-member-btn">
                        <i class="fas fa-user-plus"></i> Add Member
                    </button>
                    <button class="fullscreen-btn" id="fullscreen-toggle">
                        <i class="fas fa-expand"></i> Fullscreen
                    </button>
                    <button class="dark-mode-btn" id="dark-mode-toggle">
                        <i class="fas fa-moon"></i> Dark Mode
                    </button>
                   
                </div>
            </div>
            
            <!-- Dashboard Section (Default) -->
            <section id="dashboard-section" class="section active">
                <!-- Modern Welcome Banner -->
                <div style="background: linear-gradient(90deg, var(--royal-blue), var(--gold-light)); color: #fff; border-radius: 12px; padding: 32px 32px 24px 32px; margin-bottom: 32px; box-shadow: var(--shadow); display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">
                    <div>
                        <h2 style="font-size:2.2rem; font-weight:700; margin-bottom: 8px; color: #fff;">Welcome Back!</h2>
                        <p style="font-size:1.1rem; color: #f4f6fa;">Here's a quick overview of your church management system.</p>
                    </div>
                    <img src="logo.png" alt="Logo" style="height:60px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08); background:#fff; padding:8px;">
                </div>

                <!-- Modern Dashboard Stats -->
                <div class="dashboard-overview">
                    <div class="stat-card" style="border-left: 4px solid #059669;">
                        <div class="stat-icon" style="background:rgba(5,150,105,0.08);">
                            <svg width="32" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="16" fill="#059669" fill-opacity="0.15"/><path d="M10 22v-1a4 4 0 014-4h4a4 4 0 014 4v1" stroke="#059669" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="16" cy="13" r="3" stroke="#059669" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-members">0</h3>
                            <p>Total Members</p>
                        </div>
                    </div>
                    <div class="stat-card" style="border-left: 4px solid #2563eb;">
                        <div class="stat-icon" style="background:rgba(37,99,235,0.08);">
                            <svg width="32" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="16" fill="#2563eb" fill-opacity="0.15"/><path d="M12 16l4 4 4-4" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 12v8" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="stat-info">
                            <h3 id="new-visitors">0</h3>
                            <p>New Visitors (This Month)</p>
                        </div>
                    </div>
                    <div class="stat-card" style="border-left: 4px solid #d97706;">
                        <div class="stat-icon" style="background:rgba(217,119,6,0.08);">
                            <svg width="32" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="16" fill="#d97706" fill-opacity="0.15"/><path d="M12 20h8M12 16h8M12 12h8" stroke="#d97706" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="stat-info">
                            <h3 id="upcoming-events">0</h3>
                            <p>Upcoming Events</p>
                        </div>
                    </div>
                </div>

                <!-- Modern Recent Activity Card -->
                <div class="card" style="margin-top:32px; border-radius:12px; box-shadow:var(--shadow);">
                    <div class="card-header" style="display:flex; align-items:center; justify-content:space-between;">
                        <h3 class="card-title" style="font-size:1.2rem; font-weight:600; color:var(--royal-blue);">Recent Activity</h3>
                        <button class="btn btn-outline btn-sm" id="view-all-activity" style="border-radius:6px; border:1px solid var(--gold); color:var(--gold); background:#fff;">View All</button>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table" style="width:100%; border-collapse:collapse;">
                            <thead>
                                <tr style="background:var(--soft-light-gray); color:var(--text-dark);">
                                    <th style="padding:12px 8px;">Date</th>
                                    <th>Activity</th>
                                    <th>Member</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="recent-activity">
                                <tr>
                                    <td colspan="4" style="text-align: center; padding: 24px;">
                                        <div class="empty-state">
                                            <svg width="32" height="32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="16" fill="#e5e7eb"/><path d="M16 12v4l2 2" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                                            <p style="color:var(--text-gray);margin-top:8px;">No recent activity</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Members Section -->
            <section id="members-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-users"></i> Church Members</h3>
                        <div>
                            <input type="text" id="search-members" placeholder="Search members..." style="width: 250px; margin-right: 15px;">
                            <button class="btn btn-primary" id="filter-members-btn">Filter</button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Contact</th>
                                    <th>Ministry</th>
                                    <th>Role</th>
                                    <th>Join Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="all-members">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">
                                        <div class="empty-state">
                                            <i class="fas fa-users"></i>
                                            <h3>No Members Yet</h3>
                                            <p>Add your first member to start building your church directory</p>
                                            <button class="btn btn-primary" id="add-member-from-empty" style="margin-top: 20px;">
                                                <i class="fas fa-plus"></i> Add First Member
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Member Profiles Section -->
            <section id="member-profiles-section" class="section">
                <div class="member-profiles-container">
                    <!-- Sidebar with ministry filters -->
                    <div class="member-profiles-sidebar">
                        <h3 style="margin-bottom: 20px; color: var(--deep-blue);"><i class="fas fa-filter"></i> Filter by Ministry</h3>
                        
                        <div class="ministry-filter">
                            <h4>Church Ministries</h4>
                            <div class="ministry-filter-list" id="ministry-filters">
                                <!-- Ministry filters will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <div class="ministry-filter" style="margin-top: 30px;">
                            <h4>Member Roles</h4>
                            <div class="ministry-filter-list">
                                <div class="ministry-filter-item" data-role-type="pastor">
                                    <i class="fas fa-pastor"></i>
                                    <span style="margin-left: 10px;">Pastors</span>
                                    <span class="ministry-filter-count" id="pastors-count">0</span>
                                </div>
                                <div class="ministry-filter-item" data-role-type="elder">
                                    <i class="fas fa-user-tie"></i>
                                    <span style="margin-left: 10px;">Elders</span>
                                    <span class="ministry-filter-count" id="elders-count">0</span>
                                </div>
                                <div class="ministry-filter-item" data-role-type="deacon">
                                    <i class="fas fa-hands-helping"></i>
                                    <span style="margin-left: 10px;">Deacons</span>
                                    <span class="ministry-filter-count" id="deacons-count">0</span>
                                </div>
                                <div class="ministry-filter-item" data-role-type="volunteer">
                                    <i class="fas fa-users"></i>
                                    <span style="margin-left: 10px;">Volunteers</span>
                                    <span class="ministry-filter-count" id="volunteers-count">0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-light);">
                            <button class="btn btn-outline" id="clear-filters" style="width: 100%;">
                                <i class="fas fa-times"></i> Clear All Filters
                            </button>
                        </div>
                    </div>
                    
                    <!-- Main content area -->
                    <div class="member-profiles-content">
                        <!-- Member profile detail view (hidden by default) -->
                        <div id="member-profile-detail-view" style="display: none;">
                            <div class="member-profile-header">
                                <div class="member-profile-avatar" id="member-profile-avatar">A</div>
                                <div class="member-profile-info">
                                    <h1 class="member-profile-name" id="member-profile-name">Member Name</h1>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span class="status-badge status-active" id="member-profile-status">Active</span>
                                        <span class="role-badge role-member" id="member-profile-role">Member</span>
                                    </div>
                                    <div class="member-profile-ministries" id="member-profile-ministries-list">
                                        <!-- Ministries will be populated by JavaScript -->
                                    </div>
                                </div>
                                <button class="btn btn-outline" id="back-to-profiles">
                                    <i class="fas fa-arrow-left"></i> Back to Profiles
                                </button>
                            </div>
                            
                            <div class="member-profile-content">
                                <div class="member-profile-details">
                                    <div class="member-profile-details-section">
                                        <h3><i class="fas fa-info-circle"></i> Personal Information</h3>
                                        <div class="member-profile-details-grid">
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Full Name</div>
                                                <div class="member-detail-value" id="profile-full-name">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Date of Birth</div>
                                                <div class="member-detail-value" id="profile-dob">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Gender</div>
                                                <div class="member-detail-value" id="profile-gender">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Marital Status</div>
                                                <div class="member-detail-value" id="profile-marital">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Email</div>
                                                <div class="member-detail-value" id="profile-email">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Phone</div>
                                                <div class="member-detail-value" id="profile-phone">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Address</div>
                                                <div class="member-detail-value" id="profile-address">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Join Date</div>
                                                <div class="member-detail-value" id="profile-join-date">-</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="member-profile-details-section">
                                        <h3><i class="fas fa-pray"></i> Spiritual Information</h3>
                                        <div class="member-profile-details-grid">
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Baptism Date</div>
                                                <div class="member-detail-value" id="profile-baptism">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Spiritual Gifts</div>
                                                <div class="member-detail-value" id="profile-gifts">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Prayer Team</div>
                                                <div class="member-detail-value" id="profile-prayer-team">-</div>
                                            </div>
                                            <div class="member-detail-item">
                                                <div class="member-detail-label">Bible Study</div>
                                                <div class="member-detail-value" id="profile-bible-study">-</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="member-profile-details-section">
                                        <h3><i class="fas fa-sticky-note"></i> Notes & Additional Information</h3>
                                        <div class="member-detail-item">
                                            <div class="member-detail-label">Notes</div>
                                            <div class="member-detail-value" id="profile-notes" style="white-space: pre-line;">-</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="member-profile-documents">
                                    <div class="member-profile-details-section">
                                        <h3><i class="fas fa-file-contract"></i> Member Documents</h3>
                                        <div class="document-list" id="member-documents-list">
                                            <!-- Documents will be populated by JavaScript -->
                                        </div>
                                    </div>
                                    
                                    <div class="member-profile-details-section">
                                        <h3><i class="fas fa-users"></i> Family Members</h3>
                                        <div id="family-members">
                                            <!-- Family members will be populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ministry categories view (default view) -->
                        <div id="ministry-categories-view">
                            <!-- Ministry categories will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Visitors Section -->
            <section id="visitors-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-user-plus"></i> First-Time Visitors</h3>
                        <button class="btn btn-primary" id="add-visitor-btn">Add Visitor</button>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Contact</th>
                                    <th>Visit Date</th>
                                    <th>Service</th>
                                    <th>Interested In</th>
                                    <th>Follow-up</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="visitors-table">
                                <tr>
                                    <td colspan="8" style="text-align: center; padding: 40px;">
                                        <div class="empty-state">
                                            <i class="fas fa-user-plus"></i>
                                            <h3>No Visitors Yet</h3>
                                            <p>Add visitors to track follow-ups and connections</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            
            <!-- Church Events Section -->
            <section id="events-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Upcoming Church Events</h3>
                        <button class="btn btn-primary" id="create-event-btn">Create Event</button>
                    </div>
                    
                    <div class="events-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;" id="events-grid">
                        <!-- Events will be populated here -->
                        <div style="grid-column: 1/-1; text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-calendar-alt"></i>
                                <h3>No Events Scheduled</h3>
                                <p>Create your first church event</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Ministries Section -->
            <section id="ministries-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-pray"></i> Church Ministries</h3>
                        <button class="btn btn-primary" id="add-ministry-btn">Add Ministry</button>
                    </div>
                    
                    <div class="ministries-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;" id="ministries-grid">
                        <!-- Ministries will be populated here -->
                        <div style="grid-column: 1/-1; text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-pray"></i>
                                <h3>No Ministries Added</h3>
                                <p>Add church ministries to organize members</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Prayer Requests Section -->
            <section id="prayer-section" class="section">
                <div class="dashboard-overview" style="margin-bottom: 30px;">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-hands"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-prayers">0</h3>
                            <p>Total Prayer Requests</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="pending-prayers">0</h3>
                            <p>Needing Prayer</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="answered-prayers">0</h3>
                            <p>Answered Prayers</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="praying-members">0</h3>
                            <p>Intercessors</p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-hands"></i> Prayer Requests</h3>
                        <button class="btn btn-primary" id="add-prayer-btn">Add Prayer Request</button>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Requested By</th>
                                    <th>Prayer Request</th>
                                    <th>Category</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="prayer-table">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px;">
                                        <div class="empty-state">
                                            <i class="fas fa-hands"></i>
                                            <h3>No Prayer Requests</h3>
                                            <p>Add prayer requests to pray for your congregation</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Documents Section -->
            <section id="documents-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-file-contract"></i> Church Documents</h3>
                        <button class="btn btn-primary" id="upload-document-btn">Upload Document</button>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Document Name</th>
                                    <th>Category</th>
                                    <th>Upload Date</th>
                                    <th>Uploaded By</th>
                                    <th>Size</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="documents-table">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px;">
                                        <div class="empty-state">
                                            <i class="fas fa-file-contract"></i>
                                            <h3>No Documents Yet</h3>
                                            <p>Upload church documents and resources</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Calendar Section -->
            <section id="calendar-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Church Calendar</h3>
                        <div>
                            <button class="btn btn-outline" id="prev-month-btn"><i class="fas fa-chevron-left"></i></button>
                            <span id="current-month" style="margin: 0 15px; font-weight: 500;">January 2024</span>
                            <button class="btn btn-outline" id="next-month-btn"><i class="fas fa-chevron-right"></i></button>
                            <button class="btn btn-primary" id="add-calendar-event-btn" style="margin-left: 15px;">Add Event</button>
                        </div>
                    </div>
                    
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Calendar will be populated by JavaScript -->
                    </div>
                    
                    <div class="card" style="margin-top: 30px;">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-list"></i> Upcoming Events</h3>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Event</th>
                                        <th>Time</th>
                                        <th>Location</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="upcoming-events-table">
                                    <tr>
                                        <td colspan="5" style="text-align: center; padding: 40px;">
                                            <div class="empty-state">
                                                <i class="fas fa-calendar"></i>
                                                <p>No upcoming events</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Reports Section -->
            <section id="reports-section" class="section">
                <div class="tabs">
                    <div class="tab active" data-tab="membership">Membership</div>
                    <div class="tab" data-tab="financial">Financial</div>
                    <div class="tab" data-tab="attendance">Attendance</div>
                    <div class="tab" data-tab="outreach">Outreach</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title" id="reports-title"><i class="fas fa-chart-bar"></i> Membership Reports</h3>
                        <select id="reports-period">
                            <option>Last 30 Days</option>
                            <option>Last Quarter</option>
                            <option>Last Year</option>
                            <option>All Time</option>
                        </select>
                    </div>
                    
                    <div id="membership-tab" class="reports-tab active">
                        <div class="dashboard-grid">
                            <div class="card">
                                <h4 style="margin-bottom: 15px;">Membership Growth</h4>
                                <div class="chart-container">
                                    <div class="chart-placeholder">
                                        <div style="text-align: center;">
                                            <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 15px; color: var(--gold);"></i>
                                            <p>Membership growth chart will appear here</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <h4 style="margin-bottom: 15px;">Demographics</h4>
                                <div class="chart-container">
                                    <div class="chart-placeholder">
                                        <div style="text-align: center;">
                                            <i class="fas fa-chart-pie" style="font-size: 3rem; margin-bottom: 15px; color: var(--gold);"></i>
                                            <p>Demographic data will appear here</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="financial-tab" class="reports-tab">
                        <div class="dashboard-grid">
                          
                            
                            <div class="card">
                                <h4 style="margin-bottom: 15px;">Giving Summary</h4>
                                <div class="chart-container">
                                    <div class="chart-placeholder">
                                        <div style="text-align: center;">
                                            <i class="fas fa-chart-pie" style="font-size: 3rem; margin-bottom: 15px; color: var(--gold);"></i>
                                            <p>Giving summary will appear here</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="attendance-tab" class="reports-tab">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Service Date</th>
                                        <th>Service Type</th>
                                        <th>Attendance</th>
                                        <th>New Visitors</th>
                                        <th>Decisions</th>
                                    </tr>
                                </thead>
                                <tbody id="attendance-reports">
                                    <tr>
                                        <td colspan="5" style="text-align: center; padding: 40px;">
                                            <div class="empty-state">
                                                <i class="fas fa-church"></i>
                                                <p>No attendance data available</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div id="outreach-tab" class="reports-tab">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Outreach Event</th>
                                        <th>Date</th>
                                        <th>Participants</th>
                                        <th>Contacts Made</th>
                                        <th>Follow-ups</th>
                                    </tr>
                                </thead>
                                <tbody id="outreach-reports">
                                    <tr>
                                        <td colspan="5" style="text-align: center; padding: 40px;">
                                            <div class="empty-state">
                                                <i class="fas fa-heart"></i>
                                                <p>No outreach data available</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 30px;">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-download"></i> Export Reports</h3>
                    </div>
                    <div style="padding: 20px;">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Report Type</label>
                                <select id="report-type">
                                    <option>Membership Directory</option>
                                    <option>Financial Summary</option>
                                    <option>Attendance Report</option>
                                    <option>Prayer Request Summary</option>
                                    <option>Visitor Follow-up List</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Date Range</label>
                                <select id="report-range">
                                    <option>Last 30 Days</option>
                                    <option>Last Quarter</option>
                                    <option>Last Year</option>
                                    <option>Custom Range</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Format</label>
                                <select id="report-format">
                                    <option>PDF</option>
                                    <option>Excel (CSV)</option>
                                    <option>HTML</option>
                                </select>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button class="btn btn-primary" id="generate-report-btn" style="padding: 12px 40px;">
                                <i class="fas fa-file-download"></i> Generate & Download Report
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Settings Section -->
            <section id="settings-section" class="section">
                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-users-cog"></i> User Management</h3>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Username</th>
                                        <th>Role</th>
                                        <th>Status</th>
                                        <th>Last Login</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="users-table">
                                    <tr>
                                        <td>Pastor Michael</td>
                                        <td>pastor.michael</td>
                                        <td>Senior Pastor</td>
                                        <td><span class="status-badge status-active">Active</span></td>
                                        <td>Today</td>
                                        <td>
                                            <button class="btn btn-outline btn-sm">Edit</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Pastor Sarah</td>
                                        <td>pastor.sarah</td>
                                        <td>Associate Pastor</td>
                                        <td><span class="status-badge status-active">Active</span></td>
                                        <td>Today</td>
                                        <td>
                                            <button class="btn btn-outline btn-sm">Edit</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="btn btn-primary" id="add-user-btn">Add New User</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-cog"></i> Church Settings</h3>
                        </div>
                        <div style="padding: 15px;">
                            <div class="form-group">
                                <label>Church Name</label>
                                <input type="text" id="setting-name" value="Forward In Faith Church">
                            </div>
                            <div class="form-group">
                                <label>Senior Pastor</label>
                                <input type="text" id="setting-senior-pastor" value="Pastor Michael Johnson">
                            </div>
                            <div class="form-group">
                                <label>Church Address</label>
                                <textarea id="setting-address" rows="2">Dar Es Salaam</textarea>
                            </div>
                            <div class="form-group">
                                <label>Service Times</label>
                                <input type="text" id="setting-service-times" value="Sunday 9:00 AM & 11:00 AM, Wednesday 7:00 PM">
                            </div>
                            <div class="form-group">
                                <label>Default Currency</label>
                                <select id="setting-currency">
                                    <option>USD ($)</option>
                                    <option>Local Currency</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn btn-primary" id="save-settings-btn">Save Settings</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <!-- Notifications Panel -->
    <div class="notifications-panel" id="notifications-panel">
        <div class="notifications-header">
            <h3><i class="fas fa-bell"></i> Notifications</h3>
            <button class="close-notifications" id="close-notifications">&times;</button>
        </div>
        <div class="notifications-list" id="notifications-list">
            <!-- Notifications will be populated by JavaScript -->
        </div>
    </div>
    
    <!-- Add Member Modal -->
    <div class="modal" id="add-member-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Add New Member</h2>
                <button class="modal-close" id="close-member-modal">&times;</button>
            </div>
            <form id="member-form">
                <input type="hidden" id="member-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-firstname">First Name *</label>
                        <input type="text" id="member-firstname" required>
                    </div>
                    <div class="form-group">
                        <label for="member-lastname">Last Name *</label>
                        <input type="text" id="member-lastname" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-dob">Date of Birth</label>
                        <input type="date" id="member-dob">
                    </div>
                    <div class="form-group">
                        <label for="member-gender">Gender</label>
                        <select id="member-gender">
                            <option value="">Select</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-email">Email</label>
                        <input type="email" id="member-email">
                    </div>
                    <div class="form-group">
                        <label for="member-phone">Phone *</label>
                        <input type="tel" id="member-phone" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="member-address">Address</label>
                    <input type="text" id="member-address">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-join-date">Join Date *</label>
                        <input type="date" id="member-join-date" required>
                    </div>
                    <div class="form-group">
                        <label for="member-baptism">Baptism Date</label>
                        <input type="date" id="member-baptism">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-marital">Marital Status</label>
                        <select id="member-marital">
                            <option value="">Select</option>
                            <option value="Single">Single</option>
                            <option value="Married">Married</option>
                            <option value="Divorced">Divorced</option>
                            <option value="Widowed">Widowed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="member-role">Church Role</label>
                        <select id="member-role">
                            <option value="Member" selected>Member</option>
                            <option value="Pastor">Pastor</option>
                            <option value="Elder">Elder</option>
                            <option value="Deacon">Deacon</option>
                            <option value="Volunteer">Volunteer</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="member-ministries">Ministries Involved</label>
                    <select id="member-ministries" multiple style="height: 120px;">
                        <option value="Praise & Worship">1. Praise & Worship</option>
                        <option value="Hosting">2. Hosting</option>
                        <option value="Ushering">3. Ushering</option>
                        <option value="Man Of Integrity">4. Man Of Integrity</option>
                        <option value="Go Quickly & Tell">5. Go Quickly & Tell</option>
                        <option value="Children">6. Children</option>
                        <option value="Youth">7. Youth</option>
                        <option value="SADOP">8. SADOP</option>
                        <option value="Single Ladies">9. Single Ladies</option>
                        <option value="Finance">10. Finance</option>
                        <option value="Young Generation">11. Young Generation</option>
                    </select>
                    <small style="color: var(--text-gray);">Hold Ctrl/Cmd to select multiple</small>
                </div>
                
                <div class="form-group">
                    <label for="member-notes">Notes</label>
                    <textarea id="member-notes" rows="3"></textarea>
                </div>
                
                <div style="text-align: right; margin-top: 30px;">
                    <button type="button" class="btn btn-outline" id="cancel-member-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="member-submit-btn">Add Member</button>
                </div>
            </form>
        </div>
    </div>
    
   
    <!-- Create Event Modal -->
    <div class="modal" id="create-event-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-calendar-plus"></i> Create Church Event</h2>
                <button class="modal-close" id="close-event-modal">&times;</button>
            </div>
            <form id="event-form">
                <input type="hidden" id="event-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="event-name">Event Name *</label>
                        <input type="text" id="event-name" required>
                    </div>
                    <div class="form-group">
                        <label for="event-type">Event Type *</label>
                        <select id="event-type" required>
                            <option value="">Select Type</option>
                            <option value="Sunday Service">Sunday Service</option>
                            <option value="Bible Study">Bible Study</option>
                            <option value="Prayer Meeting">Prayer Meeting</option>
                            <option value="Youth Event">Youth Event</option>
                            <option value="Children's Ministry">Children's Ministry</option>
                            <option value="Outreach">Outreach</option>
                            <option value="Special Service">Special Service</option>
                            <option value="Conference">Conference</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="event-date">Date *</label>
                        <input type="date" id="event-date" required>
                    </div>
                    <div class="form-group">
                        <label for="event-time">Time</label>
                        <input type="time" id="event-time">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="event-location">Location</label>
                        <input type="text" id="event-location">
                    </div>
                    <div class="form-group">
                        <label for="event-leader">Event Leader</label>
                        <select id="event-leader">
                            <option value="">Select Leader</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="event-description">Description *</label>
                    <textarea id="event-description" rows="3" required></textarea>
                </div>
                
                <div style="text-align: right; margin-top: 30px;">
                    <button type="button" class="btn btn-outline" id="cancel-event-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="event-submit-btn">Create Event</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Add Prayer Request Modal -->
    <div class="modal" id="add-prayer-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-hands"></i> Add Prayer Request</h2>
                <button class="modal-close" id="close-prayer-modal">&times;</button>
            </div>
            <form id="prayer-form">
                <input type="hidden" id="prayer-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="prayer-name">Requested By *</label>
                        <input type="text" id="prayer-name" required>
                    </div>
                    <div class="form-group">
                        <label for="prayer-date">Date *</label>
                        <input type="date" id="prayer-date" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="prayer-request">Prayer Request *</label>
                    <textarea id="prayer-request" rows="4" required></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="prayer-category">Category</label>
                        <select id="prayer-category">
                            <option value="Personal">Personal</option>
                            <option value="Family">Family</option>
                            <option value="Health">Health</option>
                            <option value="Financial">Financial</option>
                            <option value="Church">Church</option>
                            <option value="Community">Community</option>
                            <option value="Thanksgiving">Thanksgiving</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="prayer-private">Privacy</label>
                        <select id="prayer-private">
                            <option value="Public">Public</option>
                            <option value="Staff Only">Staff Only</option>
                            <option value="Private">Private</option>
                        </select>
                    </div>
                </div>
                
                <div style="text-align: right; margin-top: 30px;">
                    <button type="button" class="btn btn-outline" id="cancel-prayer-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="prayer-submit-btn">Add Prayer Request</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Visitor Modal -->
    <div class="modal" id="add-visitor-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Add New Visitor</h2>
                <button class="modal-close" id="close-visitor-modal">&times;</button>
            </div>
            <form id="visitor-form">
                <input type="hidden" id="visitor-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="visitor-firstname">First Name *</label>
                        <input type="text" id="visitor-firstname" required>
                    </div>
                    <div class="form-group">
                        <label for="visitor-lastname">Last Name *</label>
                        <input type="text" id="visitor-lastname" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="visitor-email">Email</label>
                        <input type="email" id="visitor-email">
                    </div>
                    <div class="form-group">
                        <label for="visitor-phone">Phone</label>
                        <input type="tel" id="visitor-phone">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="visitor-visit-date">Visit Date *</label>
                        <input type="date" id="visitor-visit-date" required>
                    </div>
                    <div class="form-group">
                        <label for="visitor-service">Service Attended</label>
                        <select id="visitor-service">
                            <option value="">Select Service</option>
                            <option value="Sunday 9am">Sunday 9am</option>
                            <option value="Sunday 11am">Sunday 11am</option>
                            <option value="Wednesday">Wednesday Evening</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="visitor-interests">Interested In</label>
                    <select id="visitor-interests" multiple style="height: 100px;">
                        <option value="Membership">Membership</option>
                        <option value="Bible Study">Bible Study</option>
                        <option value="Prayer Team">Prayer Team</option>
                        <option value="Volunteer">Volunteer Opportunities</option>
                        <option value="Youth Group">Youth Group</option>
                        <option value="Children's Ministry">Children's Ministry</option>
                    </select>
                    <small style="color: var(--text-gray);">Hold Ctrl/Cmd to select multiple</small>
                </div>
                
                <div class="form-group">
                    <label for="visitor-notes">Notes</label>
                    <textarea id="visitor-notes" rows="2"></textarea>
                </div>
                
                <div style="text-align: right; margin-top: 30px;">
                    <button type="button" class="btn btn-outline" id="cancel-visitor-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="visitor-submit-btn">Add Visitor</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Ministry Modal -->
    <div class="modal" id="add-ministry-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-pray"></i> Add New Ministry</h2>
                <button class="modal-close" id="close-ministry-modal">&times;</button>
            </div>
            <form id="ministry-form">
                <input type="hidden" id="ministry-id">
                <div class="form-group">
                    <label for="ministry-name">Ministry Name *</label>
                    <input type="text" id="ministry-name" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="ministry-leader">Leader</label>
                        <select id="ministry-leader">
                            <option value="">Select Leader</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ministry-meeting-day">Meeting Day</label>
                        <select id="ministry-meeting-day">
                            <option value="">Select Day</option>
                            <option value="Sunday">Sunday</option>
                            <option value="Monday">Monday</option>
                            <option value="Tuesday">Tuesday</option>
                            <option value="Wednesday">Wednesday</option>
                            <option value="Thursday">Thursday</option>
                            <option value="Friday">Friday</option>
                            <option value="Saturday">Saturday</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="ministry-meeting-time">Meeting Time</label>
                        <input type="time" id="ministry-meeting-time">
                    </div>
                    <div class="form-group">
                        <label for="ministry-location">Location</label>
                        <input type="text" id="ministry-location">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ministry-description">Description</label>
                    <textarea id="ministry-description" rows="3"></textarea>
                </div>
                
                <div style="text-align: right; margin-top: 30px;">
                    <button type="button" class="btn btn-outline" id="cancel-ministry-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="ministry-submit-btn">Add Ministry</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Upload Document Modal -->
    <div class="modal" id="upload-document-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-file-upload"></i> Upload Document</h2>
                <button class="modal-close" id="close-document-modal">&times;</button>
            </div>
            <form id="document-form">
                <input type="hidden" id="document-id">
                <div class="form-group">
                    <label for="document-name">Document Name *</label>
                    <input type="text" id="document-name" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="document-category">Category</label>
                        <select id="document-category">
                            <option value="">Select Category</option>
                            <option value="Sermon Notes">Sermon Notes</option>
                            <option value="Ministry Guide">Ministry Guide</option>
                            <option value="Financial Report">Financial Report</option>
                            <option value="Policy">Policy</option>
                            <option value="Form">Form</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="document-file">File *</label>
                        <input type="file" id="document-file" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="document-description">Description</label>
                    <textarea id="document-description" rows="2"></textarea>
                </div>
                
                <div style="text-align: right; margin-top: 30px;">
                    <button type="button" class="btn btn-outline" id="cancel-document-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="document-submit-btn">Upload Document</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Take Attendance Modal -->
    <div class="modal" id="attendance-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-check-circle"></i> Take Attendance</h2>
                <button class="modal-close" id="close-attendance-modal">&times;</button>
            </div>
            <form id="attendance-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="attendance-service">Service *</label>
                        <select id="attendance-service" required>
                            <option value="">Select Service</option>
                            <option value="Sunday 9am">Sunday 9am</option>
                            <option value="Sunday 11am">Sunday 11am</option>
                            <option value="Wednesday">Wednesday Evening</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="attendance-date">Date *</label>
                        <input type="date" id="attendance-date" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Members Present</label>
                    <div id="attendance-members-list" style="max-height: 300px; overflow-y: auto; background-color: var(--soft-light-gray); padding: 15px; border-radius: var(--border-radius);">
                        <!-- Will be populated with checkboxes -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="attendance-notes">Notes</label>
                    <textarea id="attendance-notes" rows="2"></textarea>
                </div>
                
                <div style="text-align: right; margin-top: 30px;">
                    <button type="button" class="btn btn-outline" id="cancel-attendance-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Attendance</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script>
        // Modern login/signup tab logic
        document.addEventListener('DOMContentLoaded', function() {
            const tabSignin = document.getElementById('tab-signin');
            const tabSignup = document.getElementById('tab-signup');
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            tabSignin.addEventListener('click', function() {
                tabSignin.classList.add('active');
                tabSignin.style.color = 'var(--royal-blue)';
                tabSignin.style.borderBottom = '3px solid var(--gold)';
                tabSignup.classList.remove('active');
                tabSignup.style.color = 'var(--text-gray)';
                tabSignup.style.borderBottom = '3px solid transparent';
                loginForm.style.display = '';
                signupForm.style.display = 'none';
            });
            tabSignup.addEventListener('click', function() {
                tabSignup.classList.add('active');
                tabSignup.style.color = 'var(--royal-blue)';
                tabSignup.style.borderBottom = '3px solid var(--gold)';
                tabSignin.classList.remove('active');
                tabSignin.style.color = 'var(--text-gray)';
                tabSignin.style.borderBottom = '3px solid transparent';
                loginForm.style.display = 'none';
                signupForm.style.display = '';
            });
        });
        // ==================== CONFIGURATION ====================
        const API_BASE_URL = 'http://localhost:3001/api';
        
        // Current user
        let currentUser = null;
        
        // Application state
        const state = {
            users: [],
            members: [],
            visitors: [],
          
            events: [],
            ministries: [],
            prayerRequests: [],
            documents: [],
            notifications: [],
            activities: [],
            attendance: [],
            churchSettings: {
                name: "Forward In Faith",
                seniorPastor: "Pastor Michael",
                address: "123 Faith Avenue, Grace City, ST 12345",
                serviceTimes: "Sunday 9:00 AM & 11:00 AM, Wednesday 7:00 PM",
                currency: "USD ($)"
            }
        };
        
        // User roles (all have full access now)
        const userRoles = {
            pastor01: {
                name: "Pastor Michael",
                displayName: "Pastor Michael",
                role: "Senior Pastor",
                badge: "role-pastor",
                permissions: {
                    viewDashboard: true,
                    manageMembers: true,
                    viewVisitors: true,
                  
                    manageEvents: true,
                    manageMinistries: true,
                    managePrayer: true,
                    manageDocuments: true,
                    viewCalendar: true,
                    generateReports: true,
                    manageSettings: true,
                    editMembers: true,
                    deleteMembers: true,
                    deleteEvents: true,
                    deletePrayer: true,
                    deleteDocuments: true,
                    exportData: true,
                    approvePrayer: true,
                    manageUsers: true,
                    takeAttendance: true
                }
            },
            pastor02: {
                name: "Pastor Sarah",
                displayName: "Pastor Sarah",
                role: "Associate Pastor",
                badge: "role-pastor",
                permissions: {
                    viewDashboard: true,
                    manageMembers: true,
                    viewVisitors: true,
                  
                    manageEvents: true,
                    manageMinistries: true,
                    managePrayer: true,
                    manageDocuments: true,
                    viewCalendar: true,
                    generateReports: true,
                    manageSettings: false,
                    editMembers: true,
                    deleteMembers: false,
                    deleteEvents: true,
                    deletePrayer: true,
                    deleteDocuments: true,
                    exportData: true,
                    approvePrayer: true,
                    manageUsers: false,
                    takeAttendance: true
                }
            },
            elder01: {
                name: "Elder David",
                displayName: "Elder David",
                role: "Church Elder",
                badge: "role-elder",
                permissions: {
                    viewDashboard: true,
                    manageMembers: true,
                    viewVisitors: true,
                   
                    manageEvents: true,
                    manageMinistries: true,
                    managePrayer: true,
                    manageDocuments: true,
                    viewCalendar: true,
                    generateReports: true,
                    manageSettings: false,
                    editMembers: true,
                    deleteMembers: false,
                    deleteEvents: false,
                    deletePrayer: false,
                    deleteDocuments: false,
                    exportData: true,
                    approvePrayer: true,
                    manageUsers: false,
                    takeAttendance: true
                }
            },
            elder02: {
                name: "Elder Mary",
                displayName: "Elder Mary",
                role: "Church Elder",
                badge: "role-elder",
                permissions: {
                    viewDashboard: true,
                    manageMembers: true,
                    viewVisitors: true,
                
                    manageEvents: true,
                    manageMinistries: true,
                    managePrayer: true,
                    manageDocuments: true,
                    viewCalendar: true,
                    generateReports: true,
                    manageSettings: false,
                    editMembers: true,
                    deleteMembers: false,
                    deleteEvents: false,
                    deletePrayer: false,
                    deleteDocuments: false,
                    exportData: true,
                    approvePrayer: true,
                    manageUsers: false,
                    takeAttendance: true
                }
            },
            deacon01: {
                name: "Deacon John",
                displayName: "Deacon John",
                role: "Deacon",
                badge: "role-deacon",
                permissions: {
                    viewDashboard: true,
                    manageMembers: true,
                    viewVisitors: true,
                
                    manageEvents: true,
                    manageMinistries: true,
                    managePrayer: true,
                    manageDocuments: true,
                    viewCalendar: true,
                    generateReports: true,
                    manageSettings: false,
                    editMembers: true,
                    deleteMembers: false,
                    deleteEvents: false,
                    deletePrayer: false,
                    deleteDocuments: false,
                    exportData: true,
                    approvePrayer: false,
                    manageUsers: false,
                    takeAttendance: true
                }
            },
            volunteer01: {
                name: "Volunteer Coordinator",
                displayName: "Volunteer Coordinator",
                role: "Volunteer",
                badge: "role-volunteer",
                permissions: {
                    viewDashboard: true,
                    manageMembers: true,
                    viewVisitors: true,
                  
                    manageEvents: true,
                    manageMinistries: true,
                    managePrayer: true,
                    manageDocuments: true,
                    viewCalendar: true,
                    generateReports: true,
                    manageSettings: false,
                    editMembers: false,
                    deleteMembers: false,
                    deleteEvents: false,
                    deletePrayer: false,
                    deleteDocuments: false,
                    exportData: true,
                    approvePrayer: false,
                    manageUsers: false,
                    takeAttendance: true
                }
            },
            member01: {
                name: "Member Access",
                displayName: "Member",
                role: "Member",
                badge: "role-member",
                permissions: {
                    viewDashboard: true,
                    manageMembers: true,
                    viewVisitors: true,
                  
                    manageEvents: true,
                    manageMinistries: true,
                    managePrayer: true,
                    manageDocuments: true,
                    viewCalendar: true,
                    generateReports: true,
                    manageSettings: true,
                    editMembers: true,
                    deleteMembers: true,
                    deleteEvents: true,
                    deletePrayer: true,
                    deleteDocuments: true,
                    exportData: true,
                    approvePrayer: true,
                    manageUsers: true,
                    takeAttendance: true
                }
            }
        };
        
        // ==================== UTILITY FUNCTIONS ====================
        
        // Show Toast Notification
        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toast-container');
            if (!toastContainer) return;
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            if (type === 'error') icon = 'exclamation-circle';
            if (type === 'warning') icon = 'exclamation-triangle';
            
            toast.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${message}</span>
            `;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }
        
        // Format Date
        function formatDate(dateString) {
            if (!dateString) return 'Not set';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }
        
        // Modal Functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.classList.add('active');
        }
        
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.classList.remove('active');
        }
        
        // Save to LocalStorage
        function saveToLocalStorage() {
            try {
                localStorage.setItem('forwardinfaith_state', JSON.stringify(state));
                localStorage.setItem('forwardinfaith_church_settings', JSON.stringify(state.churchSettings));
            } catch (e) {
                console.error('Error saving to localStorage:', e);
            }
        }
        
        // ==================== MOBILE MENU FUNCTIONS ====================
        function initMobileMenu() {
            const menuToggle = document.getElementById('mobile-menu-toggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');
            
            if (menuToggle && sidebar && overlay) {
                menuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('mobile-open');
                    overlay.classList.toggle('active');
                });
                
                overlay.addEventListener('click', function() {
                    sidebar.classList.remove('mobile-open');
                    overlay.classList.remove('active');
                });
                
                // Close menu when clicking on a nav item (for better UX)
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', function() {
                        if (window.innerWidth <= 900) {
                            sidebar.classList.remove('mobile-open');
                            overlay.classList.remove('active');
                        }
                    });
                });
            }
            
            // Sync notifications count to mobile
            const mobileNotifBtn = document.getElementById('mobile-notifications-btn');
            const notifBtn = document.getElementById('notifications-btn');
            
            if (mobileNotifBtn && notifBtn) {
                mobileNotifBtn.addEventListener('click', function() {
                    document.getElementById('notifications-panel').classList.toggle('active');
                });
            }
            
            // Mobile dark mode toggle
            const mobileDarkToggle = document.getElementById('mobile-dark-mode-toggle');
            if (mobileDarkToggle) {
                mobileDarkToggle.addEventListener('click', toggleDarkMode);
            }
        }
        
        // ==================== INITIALIZATION ====================
        
        document.addEventListener('DOMContentLoaded', function() {
            // Hide loading screen
            setTimeout(() => {
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) loadingScreen.classList.add('hidden');
            }, 1000);
            
            // Load saved state from localStorage
            const savedState = localStorage.getItem('forwardinfaith_state');
            if (savedState) {
                try {
                    const parsedState = JSON.parse(savedState);
                    Object.assign(state, parsedState);
                } catch (e) {
                    console.error('Error loading from localStorage:', e);
                }
            }
            
            // Load church settings
            const savedSettings = localStorage.getItem('forwardinfaith_church_settings');
            if (savedSettings) {
                try {
                    Object.assign(state.churchSettings, JSON.parse(savedSettings));
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }
            
            // Check if user is already logged in
            const savedUser = localStorage.getItem('forwardinfaith_user');
            if (savedUser) {
                try {
                    const userData = JSON.parse(savedUser);
                    const roleSelect = document.getElementById('role');
                    if (roleSelect) {
                        // Find matching role
                        for (const [key, role] of Object.entries(userRoles)) {
                            if (role.displayName === userData.display_name) {
                                roleSelect.value = key;
                                break;
                            }
                        }
                    }
                    document.getElementById('username').value = userData.username || '';
                } catch (e) {
                    console.error('Error loading saved user:', e);
                }
            }
            
            // Initialize mobile menu
            initMobileMenu();
            
            // Login functionality
            const loginForm = document.getElementById('login-form');
            const loginContainer = document.getElementById('login-container');
            const appContainer = document.getElementById('app-container');
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();

                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value;
                const role = document.getElementById('role').value;

                if (!username || !password || !role) {
                    showToast('Please fill in all fields', 'error');
                    return;
                }

                // Authenticate against locally saved users
                const found = state.users.find(u => u.username === username && u.password === password && u.role === role);
                if (found) {
                    currentUser = Object.assign({}, found);

                    localStorage.setItem('forwardinfaith_user', JSON.stringify(currentUser));

                    showToast(`Welcome back, ${currentUser.displayName || currentUser.username}!`, 'success');

                    loginContainer.style.display = 'none';
                    appContainer.style.display = 'flex';

                    initializeCRM();
                } else {
                    showToast('Invalid credentials or user not found. Please sign up first.', 'error');
                }
            });
            
            // Logout functionality
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    localStorage.removeItem('forwardinfaith_user');
                    
                    currentUser = null;
                    appContainer.style.display = 'none';
                    loginContainer.style.display = 'flex';
                    
                    loginForm.reset();
                    showToast('Logged out successfully', 'success');
                });
            }

            // Signup functionality - persist new users locally
            const signupForm = document.getElementById('signup-form');
            if (signupForm) {
                signupForm.addEventListener('submit', function(e) {
                    e.preventDefault();

                        const signupId = document.getElementById('signup-id').value;
                        const username = document.getElementById('signup-username').value.trim();
                        const password = document.getElementById('signup-password').value;
                        const email = document.getElementById('signup-email').value.trim();
                        const role = document.getElementById('signup-role').value;

                    if (!username || !password || !email || !role) {
                        showToast('Please complete all signup fields', 'error');
                        return;
                    }

                    // If editing an existing user
                    if (signupId) {
                        const idx = state.users.findIndex(u => String(u.id) === String(signupId));
                        if (idx !== -1) {
                            // check username uniqueness when changed
                            if (state.users.some((u,i) => i!==idx && u.username === username)) {
                                showToast('Username already exists. Choose another.', 'error');
                                return;
                            }
                            state.users[idx] = Object.assign(state.users[idx], { username, password, email, role, displayName: username, updated_at: new Date().toISOString() });
                            saveToLocalStorage();
                            currentUser = Object.assign({}, state.users[idx]);
                            localStorage.setItem('forwardinfaith_user', JSON.stringify(currentUser));
                            showToast('User updated successfully', 'success');
                            document.getElementById('signup-id').value = '';
                            document.getElementById('signup-form').reset();
                            updateUsersTable();
                            loginContainer.style.display = 'none';
                            appContainer.style.display = 'flex';
                            initializeCRM();
                        }
                        return;
                    }

                    if (state.users.find(u => u.username === username)) {
                        showToast('Username already exists. Choose another.', 'error');
                        return;
                    }

                    const id = state.users.length ? Math.max(...state.users.map(u => u.id)) + 1 : 1;
                    const newUser = {
                        id,
                        username,
                        password,
                        email,
                        role,
                        displayName: username,
                        created_at: new Date().toISOString()
                    };

                    state.users.push(newUser);
                    saveToLocalStorage();

                    // Auto-login after signup
                    currentUser = Object.assign({}, newUser);
                    localStorage.setItem('forwardinfaith_user', JSON.stringify(currentUser));

                    showToast('Signup successful  welcome!', 'success');
                    loginContainer.style.display = 'none';
                    appContainer.style.display = 'flex';

                    initializeCRM();
                });
            }
            
            // Initialize fullscreen functionality
            initializeFullscreen();
            
            // Initialize dark mode functionality
            initializeDarkMode();
        });
        
        function initializeCRM() {
            updateUserInterface();
            initializeNavigation();
            initializeModals();
            initializeQuickActions();
            initializeAllButtons();
            // Render users and other data (do not auto-load demo data)
            updateUsersTable();
            
            // Update UI
            updateDashboard();
            updateMembersTable();
           
            updateVisitorsTable();
            updatePrayerTable();
            updateEventsGrid();
            updateMinistriesGrid();
            updateDocumentsTable();
            updateMemberProfiles();
            updateSettings();
            updateUsersTable();
            updateCalendar();
            updateNotifications();
        }
        
        function loadDemoData() {
            // Add sample members
            state.members = [
                {
                    id: 1,
                    firstName: 'John',
                    lastName: 'Smith',
                    email: 'john.smith@email.com',
                    phone: '(555) 123-4567',
                    address: '123 Main St, Anytown',
                    dob: '1980-01-15',
                    gender: 'Male',
                    joinDate: '2020-03-10',
                    baptism: '2020-04-15',
                    marital: 'Married',
                    role: 'Deacon',
                    ministries: ['Worship', 'Prayer Team'],
                    status: 'Active',
                    notes: 'Baptism scheduled'
                },
                {
                    id: 2,
                    firstName: 'Mary',
                    lastName: 'Johnson',
                    email: 'mary.j@email.com',
                    phone: '(555) 234-5678',
                    address: '456 Oak Ave, Anytown',
                    dob: '1975-05-20',
                    gender: 'Female',
                    joinDate: '2019-06-01',
                    baptism: '2019-07-15',
                    marital: 'Married',
                    role: 'Elder',
                    ministries: ["Children's Ministry", 'Hospitality'],
                    status: 'Active',
                    notes: 'Leads children\'s ministry'
                },
                {
                    id: 3,
                    firstName: 'David',
                    lastName: 'Williams',
                    email: 'david.w@email.com',
                    phone: '(555) 345-6789',
                    address: '789 Pine Rd, Anytown',
                    dob: '1990-11-08',
                    gender: 'Male',
                    joinDate: '2021-02-15',
                    baptism: '2021-03-20',
                    marital: 'Single',
                    role: 'Volunteer',
                    ministries: ['Youth Ministry', 'Outreach'],
                    status: 'Active',
                    notes: 'Helps with youth group'
                },
                {
                    id: 4,
                    firstName: 'Sarah',
                    lastName: 'Brown',
                    email: 'sarah.b@email.com',
                    phone: '(555) 456-7890',
                    address: '321 Elm St, Anytown',
                    dob: '1985-08-12',
                    gender: 'Female',
                    joinDate: '2020-09-05',
                    baptism: '2020-10-10',
                    marital: 'Married',
                    role: 'Member',
                    ministries: ['Prayer Team', 'Hospitality'],
                    status: 'Active',
                    notes: 'Prayer warrior'
                },
                {
                    id: 5,
                    firstName: 'Michael',
                    lastName: 'Davis',
                    email: 'michael.d@email.com',
                    phone: '(555) 567-8901',
                    address: '654 Maple Ave, Anytown',
                    dob: '1978-03-25',
                    gender: 'Male',
                    joinDate: '2018-11-12',
                    baptism: '2019-01-20',
                    marital: 'Married',
                    role: 'Pastor',
                    ministries: ['Worship', 'Bible Study'],
                    status: 'Active',
                    notes: 'Senior Pastor'
                }
            ];
            
            // Add sample visitors
            state.visitors = [
                {
                    id: 1,
                    firstName: 'Robert',
                    lastName: 'Wilson',
                    email: 'robert.w@email.com',
                    phone: '(555) 678-9012',
                    visitDate: '2024-01-07',
                    service: 'Sunday 11am',
                    interests: ['Membership', 'Bible Study'],
                    followUp: 'Pending',
                    status: 'New',
                    notes: 'Interested in joining'
                },
                {
                    id: 2,
                    firstName: 'Lisa',
                    lastName: 'Anderson',
                    email: 'lisa.a@email.com',
                    phone: '(555) 789-0123',
                    visitDate: '2024-01-07',
                    service: 'Sunday 9am',
                    interests: ['Youth Group', 'Volunteer'],
                    followUp: 'Scheduled',
                    status: 'Follow-up',
                    notes: 'Has 2 teenagers'
                }
            ];
            
         
            // Add sample events
            state.events = [
                {
                    id: 1,
                    name: 'Sunday Worship Service',
                    type: 'Sunday Service',
                    date: getFutureDate(0), // Today
                    time: '10:00',
                    location: 'Main Sanctuary',
                    leader: 'Pastor Michael',
                    description: 'Weekly worship service'
                },
                {
                    id: 2,
                    name: 'Bible Study',
                    type: 'Bible Study',
                    date: getFutureDate(2), // 2 days from now
                    time: '19:00',
                    location: 'Fellowship Hall',
                    leader: 'Elder David',
                    description: 'Study of the Book of Romans'
                },
                {
                    id: 3,
                    name: 'Prayer Meeting',
                    type: 'Prayer Meeting',
                    date: getFutureDate(1), // Tomorrow
                    time: '18:30',
                    location: 'Prayer Room',
                    leader: 'Sarah Brown',
                    description: 'Weekly prayer meeting'
                },
                {
                    id: 4,
                    name: 'Youth Night',
                    type: 'Youth Event',
                    date: getFutureDate(5), // 5 days from now
                    time: '18:00',
                    location: 'Youth Center',
                    leader: 'David Williams',
                    description: 'Games, worship, and teaching'
                }
            ];
            
            // Add sample ministries
            state.ministries = [
                {
                    id: 1,
                    name: 'Worship Team',
                    leader: 'John Smith',
                    members: 12,
                    meetingDay: 'Thursday',
                    meetingTime: '19:00',
                    location: 'Sanctuary',
                    description: 'Leading congregation in worship'
                },
                {
                    id: 2,
                    name: "Children's Ministry",
                    leader: 'Mary Johnson',
                    members: 8,
                    meetingDay: 'Sunday',
                    meetingTime: '09:00',
                    location: 'Children\'s Wing',
                    description: 'Teaching and nurturing children'
                },
                {
                    id: 3,
                    name: 'Youth Ministry',
                    leader: 'David Williams',
                    members: 15,
                    meetingDay: 'Friday',
                    meetingTime: '18:00',
                    location: 'Youth Center',
                    description: 'Guiding and mentoring youth'
                },
                {
                    id: 4,
                    name: 'Prayer Team',
                    leader: 'Sarah Brown',
                    members: 10,
                    meetingDay: 'Wednesday',
                    meetingTime: '18:00',
                    location: 'Prayer Room',
                    description: 'Intercessory prayer warriors'
                }
            ];
            
            // Add sample prayer requests
            state.prayerRequests = [
                {
                    id: 1,
                    name: 'Sarah Johnson',
                    date: '2024-01-08',
                    request: 'Prayer for healing from surgery',
                    category: 'Health',
                    privacy: 'Public',
                    status: 'Active',
                    answered: false
                },
                {
                    id: 2,
                    name: 'Michael Brown',
                    date: '2024-01-07',
                    request: 'Job interview this week',
                    category: 'Financial',
                    privacy: 'Public',
                    status: 'Active',
                    answered: false
                },
                {
                    id: 3,
                    name: 'Prayer Team',
                    date: '2024-01-06',
                    request: 'For our community outreach event',
                    category: 'Church',
                    privacy: 'Public',
                    status: 'Answered',
                    answered: true,
                    answered_date: '2024-01-08',
                    answered_by: 'Prayer Team'
                }
            ];
            
            // Add sample documents
            state.documents = [
                {
                    id: 1,
                    name: 'Church Constitution',
                    category: 'Policy',
                    uploadDate: '2023-12-01',
                    uploadedBy: 'Pastor Michael',
                    size: '245 KB',
                    description: 'Official church constitution'
                },
                {
                    id: 2,
                    name: 'Ministry Handbook',
                    category: 'Ministry Guide',
                    uploadDate: '2023-11-15',
                    uploadedBy: 'Elder David',
                    size: '1.2 MB',
                    description: 'Guidelines for ministry leaders'
                },
                {
                    id: 3,
                    name: '2023 Financial Report',
                    category: 'Financial Report',
                    uploadDate: '2024-01-05',
                    uploadedBy: 'Deacon John',
                    size: '512 KB',
                    description: 'Year-end financial summary'
                }
            ];
            
            // Add sample attendance records
            state.attendance = [
                {
                    id: 1,
                    service: 'Sunday 9am',
                    date: '2024-01-07',
                    attendees: [1, 2, 4, 5],
                    count: 4,
                    notes: 'Good attendance'
                },
                {
                    id: 2,
                    service: 'Sunday 11am',
                    date: '2024-01-07',
                    attendees: [1, 3],
                    count: 2,
                    notes: ''
                }
            ];
            
            // Add sample activities
            state.activities = [
                {
                    date: '2024-01-08 09:30',
                    activity: 'New Member Added',
                    member: 'Sarah Brown',
                    details: 'Joined the church'
                },
                
                {
                    date: '2024-01-07 11:00',
                    activity: 'Prayer Request',
                    member: 'Michael Brown',
                    details: 'Job interview'
                },
                {
                    date: '2024-01-06 19:30',
                    activity: 'Event Created',
                    member: 'Pastor Michael',
                    details: 'Bible Study'
                }
            ];
            
            saveToLocalStorage();
        }
        
        // Helper function to get future date
        function getFutureDate(daysFromNow) {
            const date = new Date();
            date.setDate(date.getDate() + daysFromNow);
            return date.toISOString().split('T')[0];
        }
        
        // Update User Interface
        function updateUserInterface() {
            if (!currentUser) return;
            
            const userInitial = currentUser.displayName.charAt(0).toUpperCase();
            const userName = currentUser.displayName;
            const userRole = currentUser.role;
            
            // Update sidebar
            const userAvatar = document.getElementById('user-avatar');
            const sidebarUserName = document.getElementById('sidebar-user-name');
            const sidebarUserRole = document.getElementById('sidebar-user-role');
            const sidebarUserFullRole = document.getElementById('sidebar-user-full-role');
            
            if (userAvatar) userAvatar.textContent = userInitial;
            if (sidebarUserName) sidebarUserName.textContent = userName;
            if (sidebarUserRole) {
                sidebarUserRole.textContent = userRole;
                sidebarUserRole.className = `role-badge ${currentUser.badge}`;
            }
            if (sidebarUserFullRole) sidebarUserFullRole.textContent = userRole;
            
            // Update header
            const headerUserName = document.getElementById('header-user-name');
            const headerUserRole = document.getElementById('header-user-role');
            const headerUserFullRole = document.getElementById('header-user-full-role');
            
            if (headerUserName) headerUserName.textContent = userName;
            if (headerUserRole) {
                headerUserRole.textContent = userRole;
                headerUserRole.className = `role-badge ${currentUser.badge}`;
            }
            if (headerUserFullRole) headerUserFullRole.textContent = userRole;
        }

        // Render Users Table
        function updateUsersTable() {
            const tbody = document.getElementById('users-table');
            if (!tbody) return;

            tbody.innerHTML = '';
            if (!state.users || state.users.length === 0) {
                tbody.innerHTML = `<tr><td colspan="5" style="text-align:center;padding:20px;color:var(--text-gray);">No users yet. Use Sign Up to create the first user.</td></tr>`;
                return;
            }

            state.users.forEach(u => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${u.username}</td>
                    <td>${u.email || ''}</td>
                    <td>${u.role}</td>
                    <td>${u.displayName || ''}</td>
                    <td style="white-space:nowrap;">
                        <button class="btn btn-sm btn-outline" onclick="viewUser(${u.id})">View</button>
                        <button class="btn btn-sm btn-outline" onclick="editUser(${u.id})">Edit</button>
                        <button class="btn btn-sm btn-outline" onclick="deleteUser(${u.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // User actions
        function viewUser(userId) {
            const u = state.users.find(x => x.id === userId);
            if (!u) return;
            showViewModal('User Details', `
                <strong>Username:</strong> ${u.username}<br>
                <strong>Email:</strong> ${u.email || 'N/A'}<br>
                <strong>Role:</strong> ${u.role}<br>
                <strong>Display:</strong> ${u.displayName || 'N/A'}<br>
                <strong>Created:</strong> ${u.created_at ? formatDate(u.created_at) : 'N/A'}
            `);
        }

        function editUser(userId) {
            const u = state.users.find(x => x.id === userId);
            if (!u) return;
            // Open signup tab and populate fields
            document.getElementById('tab-signup').click();
            document.getElementById('signup-id').value = u.id;
            document.getElementById('signup-username').value = u.username;
            document.getElementById('signup-password').value = u.password;
            document.getElementById('signup-email').value = u.email || '';
            document.getElementById('signup-role').value = u.role;
            showToast('Editing user  update details and submit', 'info');
        }

        function deleteUser(userId) {
            if (!confirm('Delete this user?')) return;
            const idx = state.users.findIndex(x => x.id === userId);
            if (idx !== -1) {
                const name = state.users[idx].username;
                state.users.splice(idx,1);
                saveToLocalStorage();
                updateUsersTable();
                showToast(`User ${name} deleted`, 'success');
            }
        }
        
        // Initialize Navigation
        function initializeNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            const sections = document.querySelectorAll('.section');
            const pageTitle = document.getElementById('page-title');
            
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const sectionId = this.getAttribute('data-section') + '-section';
                    
                    // Update active states
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    sections.forEach(section => {
                        section.classList.remove('active');
                        if (section.id === sectionId) {
                            section.classList.add('active');
                        }
                    });
                    
                    // Update page title
                    const sectionName = this.getAttribute('data-section');
                    if (pageTitle) {
                        const titleMap = {
                            'dashboard': 'Dashboard',
                            'members': 'Members',
                            'member-profiles': 'Member Profiles',
                            'visitors': 'Visitors',
                          
                            'events': 'Church Events',
                            'ministries': 'Ministries',
                            'prayer': 'Prayer Requests',
                            'documents': 'Documents',
                            'calendar': 'Calendar',
                            'reports': 'Reports',
                            'settings': 'Settings'
                        };
                        pageTitle.innerHTML = `<i class="fas fa-${this.querySelector('i').className.split(' ')[1]}"></i> ${titleMap[sectionName] || sectionName.charAt(0).toUpperCase() + sectionName.slice(1)}`;
                    }
                    
                    // Load section data
                    loadSectionData(sectionId);
                });
            });
        }
        
        // Load Section Data
        function loadSectionData(sectionId) {
            switch(sectionId) {
                case 'dashboard-section':
                    updateDashboard();
                    break;
                case 'members-section':
                    updateMembersTable();
                    break;
                case 'member-profiles-section':
                    updateMemberProfiles();
                    break;
                case 'visitors-section':
                    updateVisitorsTable();
                    break;
                
                case 'events-section':
                    updateEventsGrid();
                    break;
                case 'ministries-section':
                    updateMinistriesGrid();
                    break;
                case 'prayer-section':
                    updatePrayerTable();
                    break;
                case 'documents-section':
                    updateDocumentsTable();
                    break;
                case 'calendar-section':
                    updateCalendar();
                    break;
                case 'reports-section':
                    initializeReports();
                    break;
                case 'settings-section':
                    updateSettings();
                    break;
            }
        }
        
        // Initialize All Buttons
        function initializeAllButtons() {
            // Add Member from empty state
            document.getElementById('add-member-from-empty')?.addEventListener('click', () => {
                openModal('add-member-modal');
            });
            
            // Filter members
            document.getElementById('filter-members-btn')?.addEventListener('click', () => {
                const searchTerm = document.getElementById('search-members').value.toLowerCase();
                filterMembers(searchTerm);
            });
            
            // Search on enter
            document.getElementById('search-members')?.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    const searchTerm = e.target.value.toLowerCase();
                    filterMembers(searchTerm);
                }
            });
            
            // View all activity
            document.getElementById('view-all-activity')?.addEventListener('click', () => {
                showAllActivities();
            });
            
            // Add Visitor
            document.getElementById('add-visitor-btn')?.addEventListener('click', () => {
                document.getElementById('visitor-visit-date').valueAsDate = new Date();
                openModal('add-visitor-modal');
            });
            
            // Add Ministry
            document.getElementById('add-ministry-btn')?.addEventListener('click', () => {
                populateMinistryLeaders();
                openModal('add-ministry-modal');
            });
            
            // Upload Document
            document.getElementById('upload-document-btn')?.addEventListener('click', () => {
                openModal('upload-document-modal');
            });
            
            // Add Calendar Event
            document.getElementById('add-calendar-event-btn')?.addEventListener('click', () => {
                populateEventLeaders();
                openModal('create-event-modal');
            });
            
            // Calendar navigation
            document.getElementById('prev-month-btn')?.addEventListener('click', () => {
                navigateCalendar(-1);
            });
            
            document.getElementById('next-month-btn')?.addEventListener('click', () => {
                navigateCalendar(1);
            });
            
            // Reports tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const tabId = this.getAttribute('data-tab');
                    document.querySelectorAll('.reports-tab').forEach(t => t.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    document.getElementById('reports-title').innerHTML = `<i class="fas fa-chart-bar"></i> ${this.textContent} Reports`;
                });
            });
            
            // Generate Report
            document.getElementById('generate-report-btn')?.addEventListener('click', generateReport);
            
            // Add User
            document.getElementById('add-user-btn')?.addEventListener('click', () => {
                showToast('User management feature coming soon', 'info');
            });
            
            // Save Settings
            document.querySelector('#settings-section .btn-primary')?.addEventListener('click', saveSettings);
            
            // Clear filters
            document.getElementById('clear-filters')?.addEventListener('click', () => {
                document.querySelectorAll('.ministry-filter-item').forEach(item => {
                    item.classList.remove('active');
                });
                updateMemberProfiles();
            });
            
            // Notifications
            document.getElementById('notifications-btn')?.addEventListener('click', toggleNotifications);
            document.getElementById('mobile-notifications-btn')?.addEventListener('click', toggleNotifications);
            document.getElementById('close-notifications')?.addEventListener('click', () => {
                document.getElementById('notifications-panel').classList.remove('active');
            });
            
            // Quick Actions
          
            document.getElementById('quick-attendance')?.addEventListener('click', () => {
                openAttendanceModal();
            });
        }
        
        // Initialize Modals
        function initializeModals() {
            // Member Modal
            const addMemberBtn = document.getElementById('add-member-btn');
            const addMemberModal = document.getElementById('add-member-modal');
            const closeMemberModal = document.getElementById('close-member-modal');
            const cancelMemberBtn = document.getElementById('cancel-member-btn');
            const memberForm = document.getElementById('member-form');
            
            if (addMemberBtn) {
                addMemberBtn.addEventListener('click', () => {
                    document.getElementById('member-join-date').valueAsDate = new Date();
                    openModal('add-member-modal');
                });
            }
            
            if (closeMemberModal) {
                closeMemberModal.addEventListener('click', () => {
                    closeModal('add-member-modal');
                    document.getElementById('member-id').value = '';
                    document.getElementById('member-submit-btn').textContent = 'Add Member';
                    memberForm?.reset();
                });
            }
            
            if (cancelMemberBtn) {
                cancelMemberBtn.addEventListener('click', () => {
                    closeModal('add-member-modal');
                    document.getElementById('member-id').value = '';
                    document.getElementById('member-submit-btn').textContent = 'Add Member';
                    memberForm?.reset();
                });
            }
            
            if (memberForm) {
                memberForm.addEventListener('submit', handleAddMember);
            }
            
         
            // Event Modal
            const createEventBtn = document.getElementById('create-event-btn');
            const createEventModal = document.getElementById('create-event-modal');
            const closeEventModal = document.getElementById('close-event-modal');
            const cancelEventBtn = document.getElementById('cancel-event-btn');
            const eventForm = document.getElementById('event-form');
            
            if (createEventBtn) {
                createEventBtn.addEventListener('click', () => {
                    document.getElementById('event-date').valueAsDate = new Date();
                    populateEventLeaders();
                    openModal('create-event-modal');
                });
            }
            
            if (closeEventModal) {
                closeEventModal.addEventListener('click', () => {
                    closeModal('create-event-modal');
                    document.getElementById('event-id').value = '';
                    document.getElementById('event-submit-btn').textContent = 'Create Event';
                    eventForm?.reset();
                });
            }
            
            if (cancelEventBtn) {
                cancelEventBtn.addEventListener('click', () => {
                    closeModal('create-event-modal');
                    document.getElementById('event-id').value = '';
                    document.getElementById('event-submit-btn').textContent = 'Create Event';
                    eventForm?.reset();
                });
            }
            
            if (eventForm) {
                eventForm.addEventListener('submit', handleCreateEvent);
            }
            
            // Prayer Modal
            const addPrayerBtn = document.getElementById('add-prayer-btn');
            const addPrayerModal = document.getElementById('add-prayer-modal');
            const closePrayerModal = document.getElementById('close-prayer-modal');
            const cancelPrayerBtn = document.getElementById('cancel-prayer-btn');
            const prayerForm = document.getElementById('prayer-form');
            
            if (addPrayerBtn) {
                addPrayerBtn.addEventListener('click', () => {
                    document.getElementById('prayer-date').valueAsDate = new Date();
                    openModal('add-prayer-modal');
                });
            }
            
            if (closePrayerModal) {
                closePrayerModal.addEventListener('click', () => closeModal('add-prayer-modal'));
            }
            
            if (cancelPrayerBtn) {
                cancelPrayerBtn.addEventListener('click', () => {
                    closeModal('add-prayer-modal');
                    document.getElementById('prayer-id').value = '';
                    document.getElementById('prayer-submit-btn').textContent = 'Add Prayer Request';
                    document.getElementById('prayer-form')?.reset();
                });
            }
            
            if (prayerForm) {
                prayerForm.addEventListener('submit', handleAddPrayer);
            }
            
            // Visitor Modal
            const addVisitorBtn = document.getElementById('add-visitor-btn');
            const addVisitorModal = document.getElementById('add-visitor-modal');
            const closeVisitorModal = document.getElementById('close-visitor-modal');
            const cancelVisitorBtn = document.getElementById('cancel-visitor-btn');
            const visitorForm = document.getElementById('visitor-form');
            
            if (addVisitorBtn) {
                addVisitorBtn.addEventListener('click', () => {
                    document.getElementById('visitor-visit-date').valueAsDate = new Date();
                    openModal('add-visitor-modal');
                });
            }
            
            if (closeVisitorModal) {
                closeVisitorModal.addEventListener('click', () => {
                    closeModal('add-visitor-modal');
                    document.getElementById('visitor-id').value = '';
                    document.getElementById('visitor-submit-btn').textContent = 'Add Visitor';
                    visitorForm?.reset();
                });
            }
            
            if (cancelVisitorBtn) {
                cancelVisitorBtn.addEventListener('click', () => {
                    closeModal('add-visitor-modal');
                    document.getElementById('visitor-id').value = '';
                    document.getElementById('visitor-submit-btn').textContent = 'Add Visitor';
                    visitorForm?.reset();
                });
            }
            
            if (visitorForm) {
                visitorForm.addEventListener('submit', handleAddVisitor);
            }
            
            // Ministry Modal
            const addMinistryBtn = document.getElementById('add-ministry-btn');
            const addMinistryModal = document.getElementById('add-ministry-modal');
            const closeMinistryModal = document.getElementById('close-ministry-modal');
            const cancelMinistryBtn = document.getElementById('cancel-ministry-btn');
            const ministryForm = document.getElementById('ministry-form');
            
            if (addMinistryBtn) {
                addMinistryBtn.addEventListener('click', () => {
                    populateMinistryLeaders();
                    openModal('add-ministry-modal');
                });
            }
            
            if (closeMinistryModal) {
                closeMinistryModal.addEventListener('click', () => {
                    closeModal('add-ministry-modal');
                    document.getElementById('ministry-id').value = '';
                    document.getElementById('ministry-submit-btn').textContent = 'Add Ministry';
                    ministryForm?.reset();
                });
            }
            
            if (cancelMinistryBtn) {
                cancelMinistryBtn.addEventListener('click', () => {
                    closeModal('add-ministry-modal');
                    document.getElementById('ministry-id').value = '';
                    document.getElementById('ministry-submit-btn').textContent = 'Add Ministry';
                    ministryForm?.reset();
                });
            }
            
            if (ministryForm) {
                ministryForm.addEventListener('submit', handleAddMinistry);
            }
            
            // Document Modal
            const uploadDocumentBtn = document.getElementById('upload-document-btn');
            const uploadDocumentModal = document.getElementById('upload-document-modal');
            const closeDocumentModal = document.getElementById('close-document-modal');
            const cancelDocumentBtn = document.getElementById('cancel-document-btn');
            const documentForm = document.getElementById('document-form');
            
            if (uploadDocumentBtn) {
                uploadDocumentBtn.addEventListener('click', () => {
                    openModal('upload-document-modal');
                });
            }
            
            if (closeDocumentModal) {
                closeDocumentModal.addEventListener('click', () => {
                    closeModal('upload-document-modal');
                    document.getElementById('document-id').value = '';
                    document.getElementById('document-submit-btn').textContent = 'Upload Document';
                    documentForm?.reset();
                });
            }
            
            if (cancelDocumentBtn) {
                cancelDocumentBtn.addEventListener('click', () => {
                    closeModal('upload-document-modal');
                    document.getElementById('document-id').value = '';
                    document.getElementById('document-submit-btn').textContent = 'Upload Document';
                    documentForm?.reset();
                });
            }
            
            if (documentForm) {
                documentForm.addEventListener('submit', handleUploadDocument);
            }
            
            // Attendance Modal
            const attendanceModal = document.getElementById('attendance-modal');
            const closeAttendanceModal = document.getElementById('close-attendance-modal');
            const cancelAttendanceBtn = document.getElementById('cancel-attendance-btn');
            const attendanceForm = document.getElementById('attendance-form');
            
            if (closeAttendanceModal) {
                closeAttendanceModal.addEventListener('click', () => closeModal('attendance-modal'));
            }
            
            if (cancelAttendanceBtn) {
                cancelAttendanceBtn.addEventListener('click', () => closeModal('attendance-modal'));
            }
            
            if (attendanceForm) {
                attendanceForm.addEventListener('submit', handleTakeAttendance);
            }
        }
        
        // Initialize Quick Actions
        function initializeQuickActions() {
            const quickActions = [
                { id: 'quick-add-member', action: () => openModal('add-member-modal') },
               
                { id: 'quick-create-event', action: () => {
                    document.getElementById('event-date').valueAsDate = new Date();
                    populateEventLeaders();
                    openModal('create-event-modal');
                }},
                { id: 'quick-prayer-request', action: () => {
                    document.getElementById('prayer-date').valueAsDate = new Date();
                    openModal('add-prayer-modal');
                }}
            ];
            
            quickActions.forEach(qa => {
                const element = document.getElementById(qa.id);
                if (element) {
                    element.addEventListener('click', qa.action);
                }
            });
        }
        
        // Initialize Fullscreen
        function initializeFullscreen() {
            const enterFullscreenBtn = document.getElementById('enter-fullscreen-btn');
            const fullscreenToggle = document.getElementById('fullscreen-toggle');
            
            if (enterFullscreenBtn) {
                enterFullscreenBtn.addEventListener('click', enterFullscreen);
            }
            
            if (fullscreenToggle) {
                fullscreenToggle.addEventListener('click', toggleFullscreen);
            }
            
            document.addEventListener('fullscreenchange', () => {
                if (document.fullscreenElement) {
                    fullscreenToggle.innerHTML = '<i class="fas fa-compress"></i> Exit Fullscreen';
                } else {
                    fullscreenToggle.innerHTML = '<i class="fas fa-expand"></i> Fullscreen';
                }
            });
        }
        
        function enterFullscreen() {
            const elem = document.documentElement;
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            }
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                enterFullscreen();
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }
        
        // Initialize Dark Mode
        function initializeDarkMode() {
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            const mobileDarkToggle = document.getElementById('mobile-dark-mode-toggle');
            
            // Load saved theme preference
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                updateDarkModeButton(true);
            }
            
            if (darkModeToggle) {
                darkModeToggle.addEventListener('click', toggleDarkMode);
            }
            
            if (mobileDarkToggle) {
                mobileDarkToggle.addEventListener('click', toggleDarkMode);
            }
        }
        
        function toggleDarkMode() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateDarkModeButton(newTheme === 'dark');
        }
        
        function updateDarkModeButton(isDark) {
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            const mobileDarkToggle = document.getElementById('mobile-dark-mode-toggle');
            
            if (darkModeToggle) {
                if (isDark) {
                    darkModeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                } else {
                    darkModeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
                }
            }
            
            if (mobileDarkToggle) {
                if (isDark) {
                    mobileDarkToggle.innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    mobileDarkToggle.innerHTML = '<i class="fas fa-moon"></i>';
                }
            }
        }
        
        // Initialize Reports
        function initializeReports() {
            updateAttendanceReports();
            updateOutreachReports();
        }
        
        // ==================== FORM HANDLERS ====================
        
        // Handle Add Member
        function handleAddMember(e) {
            e.preventDefault();
            const memberId = document.getElementById('member-id').value;
            const memberData = {
                firstName: document.getElementById('member-firstname').value,
                lastName: document.getElementById('member-lastname').value,
                dob: document.getElementById('member-dob').value || null,
                gender: document.getElementById('member-gender').value,
                email: document.getElementById('member-email').value,
                phone: document.getElementById('member-phone').value,
                address: document.getElementById('member-address').value,
                joinDate: document.getElementById('member-join-date').value,
                baptism: document.getElementById('member-baptism').value || null,
                marital: document.getElementById('member-marital').value,
                role: document.getElementById('member-role').value,
                ministries: Array.from(document.getElementById('member-ministries').selectedOptions).map(opt => opt.value),
                notes: document.getElementById('member-notes').value,
                status: 'Active'
            };

            if (memberId) {
                // Update existing member
                const idx = state.members.findIndex(m => String(m.id) === String(memberId));
                if (idx !== -1) {
                    const oldName = `${state.members[idx].firstName} ${state.members[idx].lastName}`;
                    state.members[idx] = Object.assign(state.members[idx], memberData, { updated_at: new Date().toISOString() });
                    addActivity('Member Updated', `${state.members[idx].firstName} ${state.members[idx].lastName}`, 'Profile updated');
                    saveToLocalStorage();
                    updateMembersTable();
                    updateDashboard();
                    updateMemberProfiles();
                    closeModal('add-member-modal');
                    document.getElementById('member-form').reset();
                    document.getElementById('member-id').value = '';
                    document.getElementById('member-submit-btn').textContent = 'Add Member';
                    showToast(`Member ${oldName} updated`, 'success');
                }
                return;
            }

            // Create new member
            const newMember = Object.assign({ id: Date.now(), created_at: new Date().toISOString(), created_by: currentUser?.displayName || 'System' }, memberData);
            state.members.unshift(newMember);
            addActivity('New Member Added', `${newMember.firstName} ${newMember.lastName}`, 'Joined the church');
            saveToLocalStorage();
            updateMembersTable();
            updateDashboard();
            updateMemberProfiles();
            closeModal('add-member-modal');
            e.target.reset();
            showToast(`Member ${newMember.firstName} ${newMember.lastName} added successfully!`, 'success');
        }
        
      
        // Handle Create Event
        function handleCreateEvent(e) {
            e.preventDefault();
            const eventId = document.getElementById('event-id').value;
            const eventData = {
                name: document.getElementById('event-name').value,
                type: document.getElementById('event-type').value,
                date: document.getElementById('event-date').value,
                time: document.getElementById('event-time').value,
                location: document.getElementById('event-location').value,
                leader: document.getElementById('event-leader').value,
                description: document.getElementById('event-description').value,
                created_by: currentUser?.displayName || 'System'
            };

            if (eventId) {
                const idx = state.events.findIndex(ev => String(ev.id) === String(eventId));
                if (idx !== -1) {
                    state.events[idx] = Object.assign(state.events[idx], eventData, { updated_at: new Date().toISOString() });
                    addActivity('Event Updated', state.events[idx].name, state.events[idx].description.substring(0,50));
                    saveToLocalStorage();
                    updateEventsGrid();
                    updateCalendar();
                    closeModal('create-event-modal');
                    document.getElementById('event-form').reset();
                    document.getElementById('event-id').value = '';
                    document.getElementById('event-submit-btn').textContent = 'Create Event';
                    showToast(`Event "${state.events[idx].name}" updated`, 'success');
                }
                return;
            }

            const newEvent = Object.assign({ id: Date.now(), created_at: new Date().toISOString() }, eventData);
            state.events.unshift(newEvent);
            addActivity('Event Created', newEvent.name, newEvent.description.substring(0, 50));
            saveToLocalStorage();
            updateEventsGrid();
            updateCalendar();
            closeModal('create-event-modal');
            e.target.reset();
            showToast(`Event "${newEvent.name}" created successfully!`, 'success');
        }
        
        // Handle Add Prayer Request
        function handleAddPrayer(e) {
            e.preventDefault();
            const prayerId = document.getElementById('prayer-id').value;
            const prayerData = {
                name: document.getElementById('prayer-name').value,
                date: document.getElementById('prayer-date').value,
                request: document.getElementById('prayer-request').value,
                category: document.getElementById('prayer-category').value,
                privacy: document.getElementById('prayer-private').value,
                status: 'Active',
                answered: false,
                created_by: currentUser?.displayName || 'System'
            };

            if (prayerId) {
                const idx = state.prayerRequests.findIndex(p => String(p.id) === String(prayerId));
                if (idx !== -1) {
                    state.prayerRequests[idx] = Object.assign(state.prayerRequests[idx], prayerData, { updated_at: new Date().toISOString() });
                    addActivity('Prayer Updated', state.prayerRequests[idx].name, state.prayerRequests[idx].category);
                    saveToLocalStorage();
                    updatePrayerTable();
                    updateDashboard();
                    closeModal('add-prayer-modal');
                    document.getElementById('prayer-form').reset();
                    document.getElementById('prayer-id').value = '';
                    document.getElementById('prayer-submit-btn').textContent = 'Add Prayer Request';
                    showToast('Prayer request updated!', 'success');
                }
                return;
            }

            const newPrayer = Object.assign({ id: Date.now(), created_at: new Date().toISOString() }, prayerData);
            state.prayerRequests.unshift(newPrayer);
            addActivity('Prayer Request', newPrayer.name, newPrayer.category);
            saveToLocalStorage();
            updatePrayerTable();
            updateDashboard();
            closeModal('add-prayer-modal');
            e.target.reset();
            showToast('Prayer request added successfully!', 'success');
        }
        
        // Handle Add Visitor
        function handleAddVisitor(e) {
            e.preventDefault();
            const visitorId = document.getElementById('visitor-id').value;
            const visitorData = {
                firstName: document.getElementById('visitor-firstname').value,
                lastName: document.getElementById('visitor-lastname').value,
                email: document.getElementById('visitor-email').value,
                phone: document.getElementById('visitor-phone').value,
                visitDate: document.getElementById('visitor-visit-date').value,
                service: document.getElementById('visitor-service').value,
                interests: Array.from(document.getElementById('visitor-interests').selectedOptions).map(opt => opt.value),
                notes: document.getElementById('visitor-notes').value,
                followUp: 'Pending',
                status: 'New',
                created_by: currentUser?.displayName || 'System'
            };

            if (visitorId) {
                const idx = state.visitors.findIndex(v => String(v.id) === String(visitorId));
                if (idx !== -1) {
                    state.visitors[idx] = Object.assign(state.visitors[idx], visitorData, { updated_at: new Date().toISOString() });
                    addActivity('Visitor Updated', `${state.visitors[idx].firstName} ${state.visitors[idx].lastName}`, `Visited ${state.visitors[idx].service || 'service'}`);
                    saveToLocalStorage();
                    updateVisitorsTable();
                    updateDashboard();
                    closeModal('add-visitor-modal');
                    document.getElementById('visitor-form').reset();
                    document.getElementById('visitor-id').value = '';
                    document.getElementById('visitor-submit-btn').textContent = 'Add Visitor';
                    showToast(`Visitor ${state.visitors[idx].firstName} ${state.visitors[idx].lastName} updated`, 'success');
                }
                return;
            }

            const newVisitor = Object.assign({ id: Date.now(), created_at: new Date().toISOString() }, visitorData);
            state.visitors.unshift(newVisitor);
            addActivity('New Visitor', `${newVisitor.firstName} ${newVisitor.lastName}`, `Visited ${newVisitor.service || 'service'}`);
            saveToLocalStorage();
            updateVisitorsTable();
            updateDashboard();
            closeModal('add-visitor-modal');
            e.target.reset();
            showToast(`Visitor ${newVisitor.firstName} ${newVisitor.lastName} added successfully!`, 'success');
        }
        
        // Handle Add Ministry
        function handleAddMinistry(e) {
            e.preventDefault();
            const ministryId = document.getElementById('ministry-id').value;
            const ministryData = {
                name: document.getElementById('ministry-name').value,
                leader: document.getElementById('ministry-leader').value,
                meetingDay: document.getElementById('ministry-meeting-day').value,
                meetingTime: document.getElementById('ministry-meeting-time').value,
                location: document.getElementById('ministry-location').value,
                description: document.getElementById('ministry-description').value,
                members: 0,
                created_by: currentUser?.displayName || 'System'
            };

            if (ministryId) {
                const idx = state.ministries.findIndex(m => String(m.id) === String(ministryId));
                if (idx !== -1) {
                    state.ministries[idx] = Object.assign(state.ministries[idx], ministryData, { updated_at: new Date().toISOString() });
                    addActivity('Ministry Updated', state.ministries[idx].name, `Led by ${state.ministries[idx].leader || 'TBD'}`);
                    saveToLocalStorage();
                    updateMinistriesGrid();
                    closeModal('add-ministry-modal');
                    document.getElementById('ministry-form').reset();
                    document.getElementById('ministry-id').value = '';
                    document.getElementById('ministry-submit-btn').textContent = 'Add Ministry';
                    showToast(`Ministry "${state.ministries[idx].name}" updated`, 'success');
                }
                return;
            }

            const newMinistry = Object.assign({ id: Date.now(), created_at: new Date().toISOString() }, ministryData);
            state.ministries.unshift(newMinistry);
            addActivity('Ministry Added', newMinistry.name, `Led by ${newMinistry.leader || 'TBD'}`);
            saveToLocalStorage();
            updateMinistriesGrid();
            closeModal('add-ministry-modal');
            e.target.reset();
            showToast(`Ministry "${newMinistry.name}" added successfully!`, 'success');
        }
        
        // Handle Upload Document
        function handleUploadDocument(e) {
            e.preventDefault();
            const docId = document.getElementById('document-id').value;
            const fileInput = document.getElementById('document-file');
            const file = fileInput.files[0];

            // If editing an existing document, update metadata only (file optional)
            if (docId) {
                const idx = state.documents.findIndex(d => String(d.id) === String(docId));
                if (idx !== -1) {
                    const doc = state.documents[idx];
                    doc.name = document.getElementById('document-name').value;
                    doc.category = document.getElementById('document-category').value;
                    doc.description = document.getElementById('document-description').value;
                    doc.updated_at = new Date().toISOString();
                    // If a new file is provided, update file info
                    if (file) {
                        doc.uploadDate = new Date().toISOString().split('T')[0];
                        doc.size = formatFileSize(file.size);
                        doc.fileName = file.name;
                        doc.fileType = file.type;
                    }
                    addActivity('Document Updated', doc.name, doc.category);
                    saveToLocalStorage();
                    updateDocumentsTable();
                    closeModal('upload-document-modal');
                    document.getElementById('document-form').reset();
                    document.getElementById('document-id').value = '';
                    document.getElementById('document-submit-btn').textContent = 'Upload Document';
                    showToast(`Document "${doc.name}" updated`, 'success');
                }
                return;
            }

            if (!file) {
                showToast('Please select a file to upload', 'error');
                return;
            }

            const newDocument = {
                id: Date.now(),
                name: document.getElementById('document-name').value,
                category: document.getElementById('document-category').value,
                description: document.getElementById('document-description').value,
                uploadDate: new Date().toISOString().split('T')[0],
                uploadedBy: currentUser?.displayName || 'System',
                size: formatFileSize(file.size),
                fileName: file.name,
                fileType: file.type
            };

            state.documents.unshift(newDocument);
            addActivity('Document Uploaded', newDocument.name, newDocument.category);
            saveToLocalStorage();
            updateDocumentsTable();
            closeModal('upload-document-modal');
            e.target.reset();
            showToast(`Document "${newDocument.name}" uploaded successfully!`, 'success');
        }
        
        // Handle Take Attendance
        function handleTakeAttendance(e) {
            e.preventDefault();
            
            const checkboxes = document.querySelectorAll('#attendance-members-list input[type="checkbox"]:checked');
            const attendees = Array.from(checkboxes).map(cb => parseInt(cb.value));
            
            const newAttendance = {
                id: Date.now(),
                service: document.getElementById('attendance-service').value,
                date: document.getElementById('attendance-date').value,
                attendees: attendees,
                count: attendees.length,
                notes: document.getElementById('attendance-notes').value,
                recorded_by: currentUser?.displayName || 'System',
                recorded_at: new Date().toISOString()
            };
            
            state.attendance.unshift(newAttendance);
            
            // Add activity
            addActivity('Attendance Taken', newAttendance.service, `${newAttendance.count} members present`);
            
            saveToLocalStorage();
            
            closeModal('attendance-modal');
            e.target.reset();
            
            showToast(`Attendance recorded for ${newAttendance.service}`, 'success');
        }
        
        // Helper: Format file size
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }
        
        // Helper: Add activity
        function addActivity(activity, member, details) {
            state.activities.unshift({
                date: new Date().toLocaleString(),
                activity: activity,
                member: member,
                details: details
            });
            
            // Keep only last 20 activities
            if (state.activities.length > 20) {
                state.activities = state.activities.slice(0, 20);
            }
        }
        
      
        
        // Populate Event Leaders Select
        function populateEventLeaders() {
            const select = document.getElementById('event-leader');
            if (!select) return;
            
            select.innerHTML = '<option value="">Select Leader</option>';
            
            // Add pastors, elders, and deacons as potential leaders
            const leaders = state.members.filter(m => 
                m.role === 'Pastor' || m.role === 'Elder' || m.role === 'Deacon'
            );
            
            leaders.forEach(leader => {
                const option = document.createElement('option');
                option.value = `${leader.firstName} ${leader.lastName}`;
                option.textContent = `${leader.firstName} ${leader.lastName} (${leader.role})`;
                select.appendChild(option);
            });
        }
        
        // Populate Ministry Leaders
        function populateMinistryLeaders() {
            const select = document.getElementById('ministry-leader');
            if (!select) return;
            
            select.innerHTML = '<option value="">Select Leader</option>';
            
            state.members.forEach(member => {
                const option = document.createElement('option');
                option.value = `${member.firstName} ${member.lastName}`;
                option.textContent = `${member.firstName} ${member.lastName} (${member.role})`;
                select.appendChild(option);
            });
        }
        
        // ==================== TABLE UPDATES ====================
        
        // Update Members Table
        function updateMembersTable() {
            const tableBody = document.getElementById('all-members');
            if (!tableBody) return;
            
            if (state.members.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-users"></i>
                                <h3>No Members Yet</h3>
                                <p>Add your first member to start building your church directory</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            state.members.forEach(member => {
                const statusClass = member.status === 'Active' ? 'status-active' : 'status-inactive';
                
                // Format ministries
                let ministriesHtml = '';
                const ministries = Array.isArray(member.ministries) ? member.ministries : [];
                ministries.slice(0, 2).forEach(ministry => {
                    ministriesHtml += `<span class="service-tag">${ministry}</span>`;
                });
                if (ministries.length > 2) {
                    ministriesHtml += `<span class="service-tag">+${ministries.length - 2}</span>`;
                }
                
                html += `
                    <tr>
                        <td>
                            <div style="font-weight: 500;">${member.firstName} ${member.lastName}</div>
                        </td>
                        <td>
                            <div>${member.email || 'N/A'}</div>
                            <div style="font-size: 0.85rem; color: var(--text-gray);">${member.phone}</div>
                        </td>
                        <td>${ministriesHtml || 'None'}</td>
                        <td><span class="role-badge role-${member.role?.toLowerCase() || 'member'}">${member.role || 'Member'}</span></td>
                        <td>${formatDate(member.joinDate)}</td>
                        <td><span class="status-badge ${statusClass}">${member.status}</span></td>
                        <td>
                            <button class="btn btn-outline btn-sm" onclick="viewMember(${member.id})">View</button>
                            <button class="btn btn-outline btn-sm" onclick="editMember(${member.id})">Edit</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteMember(${member.id})">Delete</button>
                        </td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
        }
        
        // Filter Members
        function filterMembers(searchTerm) {
            if (!searchTerm) {
                updateMembersTable();
                return;
            }
            
            const filtered = state.members.filter(member => 
                member.firstName.toLowerCase().includes(searchTerm) ||
                member.lastName.toLowerCase().includes(searchTerm) ||
                member.email?.toLowerCase().includes(searchTerm) ||
                member.phone?.includes(searchTerm)
            );
            
            const tableBody = document.getElementById('all-members');
            if (filtered.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-search"></i>
                                <h3>No Members Found</h3>
                                <p>No members match your search criteria</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            filtered.forEach(member => {
                const statusClass = member.status === 'Active' ? 'status-active' : 'status-inactive';
                
                // Format ministries
                let ministriesHtml = '';
                const ministries = Array.isArray(member.ministries) ? member.ministries : [];
                ministries.slice(0, 2).forEach(ministry => {
                    ministriesHtml += `<span class="service-tag">${ministry}</span>`;
                });
                if (ministries.length > 2) {
                    ministriesHtml += `<span class="service-tag">+${ministries.length - 2}</span>`;
                }
                
                html += `
                    <tr>
                        <td>
                            <div style="font-weight: 500;">${member.firstName} ${member.lastName}</div>
                        </td>
                        <td>
                            <div>${member.email || 'N/A'}</div>
                            <div style="font-size: 0.85rem; color: var(--text-gray);">${member.phone}</div>
                        </td>
                        <td>${ministriesHtml || 'None'}</td>
                        <td><span class="role-badge role-${member.role?.toLowerCase() || 'member'}">${member.role || 'Member'}</span></td>
                        <td>${formatDate(member.joinDate)}</td>
                        <td><span class="status-badge ${statusClass}">${member.status}</span></td>
                        <td>
                            <button class="btn btn-outline btn-sm" onclick="viewMember(${member.id})">View</button>
                            <button class="btn btn-outline btn-sm" onclick="editMember(${member.id})">Edit</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteMember(${member.id})">Delete</button>
                        </td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
        }
        
        
        // Update Visitors Table
        function updateVisitorsTable() {
            const tableBody = document.getElementById('visitors-table');
            if (!tableBody) return;
            
            if (state.visitors.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-user-plus"></i>
                                <h3>No Visitors Yet</h3>
                                <p>Add visitors to track follow-ups and connections</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            state.visitors.forEach(visitor => {
                const statusClass = visitor.status === 'New' ? 'status-active' : 
                                   visitor.status === 'Follow-up' ? 'status-pending' : 'status-completed';
                
                html += `
                    <tr>
                        <td>${visitor.firstName} ${visitor.lastName}</td>
                        <td>
                            <div>${visitor.email || 'N/A'}</div>
                            <div style="font-size: 0.85rem; color: var(--text-gray);">${visitor.phone || 'N/A'}</div>
                        </td>
                        <td>${formatDate(visitor.visitDate)}</td>
                        <td>${visitor.service || 'N/A'}</td>
                        <td>
                            ${(visitor.interests || []).map(i => `<span class="service-tag">${i}</span>`).join('') || 'None'}
                        </td>
                        <td>${visitor.followUp || 'Pending'}</td>
                        <td><span class="status-badge ${statusClass}">${visitor.status}</span></td>
                        <td>
                            <button class="btn btn-outline btn-sm" onclick="viewVisitor(${visitor.id})">View</button>
                            <button class="btn btn-outline btn-sm" onclick="editVisitor(${visitor.id})">Edit</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteVisitor(${visitor.id})">Delete</button>
                        </td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
        }
        
        // Update Prayer Table
        function updatePrayerTable() {
            const tableBody = document.getElementById('prayer-table');
            if (!tableBody) return;
            
            if (state.prayerRequests.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-hands"></i>
                                <h3>No Prayer Requests</h3>
                                <p>Add prayer requests to pray for your congregation</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            state.prayerRequests.forEach(prayer => {
                const statusClass = prayer.answered ? 'status-completed' : 'status-active';
                const statusText = prayer.answered ? 'Answered' : 'Active';
                
                html += `
                    <tr>
                        <td>${formatDate(prayer.date)}</td>
                        <td>${prayer.name}</td>
                        <td>${prayer.request.substring(0, 50)}${prayer.request.length > 50 ? '...' : ''}</td>
                        <td>${prayer.category}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <button class="btn btn-outline btn-sm" onclick="viewPrayer(${prayer.id})">View</button>
                            ${!prayer.answered ? `<button class="btn btn-success btn-sm" onclick="markPrayerAnswered(${prayer.id})">Mark Answered</button>` : ''}
                            <button class="btn btn-outline btn-sm" onclick="deletePrayer(${prayer.id})">Delete</button>
                        </td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            
            // Update prayer stats
            document.getElementById('total-prayers').textContent = state.prayerRequests.length;
            document.getElementById('pending-prayers').textContent = state.prayerRequests.filter(p => !p.answered).length;
            document.getElementById('answered-prayers').textContent = state.prayerRequests.filter(p => p.answered).length;
            document.getElementById('praying-members').textContent = new Set(state.prayerRequests.map(p => p.name)).size;
        }
        
        // Update Events Grid
        function updateEventsGrid() {
            const grid = document.getElementById('events-grid');
            if (!grid) return;
            
            if (state.events.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px;">
                        <div class="empty-state">
                            <i class="fas fa-calendar-alt"></i>
                            <h3>No Events Scheduled</h3>
                            <p>Create your first church event</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '';
            // Sort by date
            const sortedEvents = [...state.events].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            sortedEvents.forEach(event => {
                const eventDate = new Date(event.date);
                const formattedDate = eventDate.toLocaleDateString('en-US', { 
                    weekday: 'short', 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                html += `
                    <div class="card" style="padding: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <span class="status-badge status-active">${event.type}</span>
                            <small style="color: var(--text-gray);">${formattedDate} ${event.time || ''}</small>
                        </div>
                        <h4 style="margin-bottom: 10px; color: var(--deep-blue);">${event.name}</h4>
                        <p style="color: var(--text-gray); font-size: 0.9rem; margin-bottom: 15px;">${event.description.substring(0, 100)}${event.description.length > 100 ? '...' : ''}</p>
                        <div style="display: flex; gap: 15px; font-size: 0.9rem; color: var(--text-gray); margin-bottom: 15px;">
                            <span><i class="fas fa-map-marker-alt"></i> ${event.location || 'TBD'}</span>
                            <span><i class="fas fa-user"></i> ${event.leader || 'TBD'}</span>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-outline btn-sm" onclick="viewEvent(${event.id})">Details</button>
                            <button class="btn btn-outline btn-sm" onclick="editEvent(${event.id})">Edit</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteEvent(${event.id})">Delete</button>
                        </div>
                    </div>
                `;
            });
            
            grid.innerHTML = html;
        }
        
        // Update Ministries Grid
        function updateMinistriesGrid() {
            const grid = document.getElementById('ministries-grid');
            if (!grid) return;
            
            if (state.ministries.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px;">
                        <div class="empty-state">
                            <i class="fas fa-pray"></i>
                            <h3>No Ministries Added</h3>
                            <p>Add church ministries to organize members</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '';
            state.ministries.forEach(ministry => {
                // Count members in this ministry
                const memberCount = state.members.filter(m => 
                    m.ministries && m.ministries.includes(ministry.name)
                ).length;
                
                html += `
                    <div class="card" style="padding: 20px;">
                        <h4 style="margin-bottom: 10px; color: var(--deep-blue);">${ministry.name}</h4>
                        <div style="display: flex; gap: 15px; font-size: 0.9rem; color: var(--text-gray); margin-bottom: 10px;">
                            <span><i class="fas fa-user"></i> Leader: ${ministry.leader || 'TBD'}</span>
                            <span><i class="fas fa-users"></i> ${memberCount} members</span>
                        </div>
                        <div style="display: flex; gap: 15px; font-size: 0.9rem; color: var(--text-gray); margin-bottom: 10px;">
                            <span><i class="fas fa-clock"></i> ${ministry.meetingDay || 'TBD'} ${ministry.meetingTime || ''}</span>
                            <span><i class="fas fa-map-marker-alt"></i> ${ministry.location || 'TBD'}</span>
                        </div>
                        <p style="color: var(--text-gray); font-size: 0.9rem; margin-bottom: 15px;">${ministry.description || ''}</p>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-outline btn-sm" onclick="viewMinistry(${ministry.id})">View Members</button>
                            <button class="btn btn-outline btn-sm" onclick="editMinistry(${ministry.id})">Edit</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteMinistry(${ministry.id})">Delete</button>
                        </div>
                    </div>
                `;
            });
            
            grid.innerHTML = html;
        }
        
        // Update Documents Table
        function updateDocumentsTable() {
            const tableBody = document.getElementById('documents-table');
            if (!tableBody) return;
            
            if (state.documents.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-file-contract"></i>
                                <h3>No Documents Yet</h3>
                                <p>Upload church documents and resources</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            state.documents.forEach(doc => {
                html += `
                    <tr>
                        <td>${doc.name}</td>
                        <td>${doc.category || 'Uncategorized'}</td>
                        <td>${formatDate(doc.uploadDate)}</td>
                        <td>${doc.uploadedBy}</td>
                        <td>${doc.size}</td>
                        <td>
                            <button class="btn btn-outline btn-sm" onclick="downloadDocument(${doc.id})">Download</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteDocument(${doc.id})">Delete</button>
                        </td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
        }
        
        // Update Member Profiles
        function updateMemberProfiles() {
            // Update ministry filters
            const ministryFilters = document.getElementById('ministry-filters');
            if (ministryFilters) {
                const ministries = [
                    'Praise & Worship',
                    'Hosting',
                    'Ushering',
                    'Man Of Integrity',
                    'Go Quickly & Tell',
                    'Children',
                    'Youth',
                    'SADOP',
                    'Single Ladies',
                    'Finance',
                    'Young Generation'
                ];
                let filterHtml = '';
                ministries.forEach(ministry => {
                    const count = state.members.filter(m => m.ministries?.includes(ministry)).length;
                    filterHtml += `
                        <div class="ministry-filter-item" data-ministry="${ministry}" onclick="filterByMinistry('${ministry}')">
                            <i class="fas fa-pray"></i>
                            <span style="margin-left: 10px;">${ministry}</span>
                            <span class="ministry-filter-count">${count}</span>
                        </div>
                    `;
                });
                ministryFilters.innerHTML = filterHtml;
            }
            
            // Update role counts
            document.getElementById('pastors-count').textContent = state.members.filter(m => m.role === 'Pastor').length;
            document.getElementById('elders-count').textContent = state.members.filter(m => m.role === 'Elder').length;
            document.getElementById('deacons-count').textContent = state.members.filter(m => m.role === 'Deacon').length;
            document.getElementById('volunteers-count').textContent = state.members.filter(m => m.role === 'Volunteer').length;
            
            // Add click handlers for role filters
            document.querySelectorAll('[data-role-type]').forEach(el => {
                el.onclick = function() {
                    const role = this.getAttribute('data-role-type');
                    filterByRole(role);
                };
            });
            
            // Show ministry categories view
            const ministryCategoriesView = document.getElementById('ministry-categories-view');
            if (ministryCategoriesView) {
                let ministryHtml = '';
                
                // Group members by ministry
                const ministryMap = new Map();
                state.members.forEach(member => {
                    if (member.ministries) {
                        member.ministries.forEach(ministry => {
                            if (!ministryMap.has(ministry)) {
                                ministryMap.set(ministry, []);
                            }
                            ministryMap.get(ministry).push(member);
                        });
                    }
                });
                
                if (ministryMap.size === 0) {
                    ministryHtml = `
                        <div class="empty-state">
                            <i class="fas fa-users"></i>
                            <h3>No Members Yet</h3>
                            <p>Add members to see them grouped by ministry</p>
                        </div>
                    `;
                } else {
                    ministryMap.forEach((members, ministry) => {
                        ministryHtml += `
                            <div class="ministry-card">
                                <div class="ministry-card-header">
                                    <div class="ministry-card-title">
                                        <i class="fas fa-pray"></i> ${ministry}
                                    </div>
                                    <div class="ministry-card-count">${members.length}</div>
                                </div>
                                <div class="members-grid">
                        `;
                        
                        members.slice(0, 3).forEach(member => {
                            ministryHtml += `
                                <div class="member-card" onclick="viewMemberProfile(${member.id})">
                                    <div class="member-card-header">
                                        <div class="member-card-avatar">${member.firstName.charAt(0)}${member.lastName.charAt(0)}</div>
                                        <div class="member-card-info">
                                            <div class="member-card-name">${member.firstName} ${member.lastName}</div>
                                            <div class="member-card-role">${member.role || 'Member'}</div>
                                        </div>
                                    </div>
                                    <div class="member-card-details">
                                        <span><i class="fas fa-phone"></i> ${member.phone}</span>
                                        <span><i class="fas fa-calendar"></i> Joined ${formatDate(member.joinDate)}</span>
                                    </div>
                                </div>
                            `;
                        });
                        
                        if (members.length > 3) {
                            ministryHtml += `
                                <div style="grid-column: 1/-1; text-align: center; padding: 10px;">
                                    <button class="btn btn-outline btn-sm" onclick="filterByMinistry('${ministry}')">View all ${members.length} members</button>
                                </div>
                            `;
                        }
                        
                        ministryHtml += `
                                </div>
                            </div>
                        `;
                    });
                }
                
                ministryCategoriesView.innerHTML = ministryHtml;
            }
        }
        
        // Filter by ministry
        function filterByMinistry(ministry) {
            // Highlight the selected filter
            document.querySelectorAll('.ministry-filter-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-ministry') === ministry) {
                    item.classList.add('active');
                }
            });
            
            // Filter members
            const filteredMembers = state.members.filter(m => 
                m.ministries && m.ministries.includes(ministry)
            );
            
            displayFilteredMembers(filteredMembers, `Ministry: ${ministry}`);
        }
        
        // Filter by role
        function filterByRole(role) {
            // Capitalize first letter
            const roleCapitalized = role.charAt(0).toUpperCase() + role.slice(1);
            
            // Highlight the selected filter
            document.querySelectorAll('[data-role-type]').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-role-type') === role) {
                    item.classList.add('active');
                }
            });
            
            // Filter members
            const filteredMembers = state.members.filter(m => 
                m.role?.toLowerCase() === role.toLowerCase()
            );
            
            displayFilteredMembers(filteredMembers, `Role: ${roleCapitalized}s`);
        }
        
        // Display filtered members
        function displayFilteredMembers(members, title) {
            const ministryCategoriesView = document.getElementById('ministry-categories-view');
            
            if (members.length === 0) {
                ministryCategoriesView.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h3>No Members Found</h3>
                        <p>No members match the selected filter</p>
                        <button class="btn btn-outline" onclick="updateMemberProfiles()" style="margin-top: 20px;">
                            <i class="fas fa-arrow-left"></i> Back to All Ministries
                        </button>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--deep-blue);">Filtered by: ${title}</h3>
                    <button class="btn btn-outline btn-sm" onclick="updateMemberProfiles()" style="margin-top: 10px;">
                        <i class="fas fa-arrow-left"></i> Back to All Ministries
                    </button>
                </div>
                <div class="members-grid">
            `;
            
            members.forEach(member => {
                html += `
                    <div class="member-card" onclick="viewMemberProfile(${member.id})">
                        <div class="member-card-header">
                            <div class="member-card-avatar">${member.firstName.charAt(0)}${member.lastName.charAt(0)}</div>
                            <div class="member-card-info">
                                <div class="member-card-name">${member.firstName} ${member.lastName}</div>
                                <div class="member-card-role">${member.role || 'Member'}</div>
                            </div>
                        </div>
                        <div class="member-card-details">
                            <span><i class="fas fa-phone"></i> ${member.phone}</span>
                            <span><i class="fas fa-calendar"></i> Joined ${formatDate(member.joinDate)}</span>
                        </div>
                        <div style="margin-top: 10px;">
                            ${(member.ministries || []).map(m => `<span class="service-tag">${m}</span>`).join('')}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            ministryCategoriesView.innerHTML = html;
        }
        
        // Update Calendar
        let currentCalendarDate = new Date();
        
        function updateCalendar() {
            const calendarGrid = document.getElementById('calendar-grid');
            if (!calendarGrid) return;
            
            const currentMonth = currentCalendarDate.getMonth();
            const currentYear = currentCalendarDate.getFullYear();
            
            document.getElementById('current-month').textContent = 
                currentCalendarDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            
            // Get first day of month
            const firstDay = new Date(currentYear, currentMonth, 1);
            const startingDay = firstDay.getDay(); // 0 = Sunday
            
            // Get last day of month
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const totalDays = lastDay.getDate();
            
            let calendarHtml = '';
            
            // Add day headers
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            days.forEach(day => {
                calendarHtml += `<div class="calendar-day-header">${day}</div>`;
            });
            
            // Add empty cells for days before month start
            for (let i = 0; i < startingDay; i++) {
                calendarHtml += `<div class="calendar-day"></div>`;
            }
            
            // Add days of month
            for (let day = 1; day <= totalDays; day++) {
                const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                // Find events on this day
                const dayEvents = state.events.filter(e => e.date === dateStr);
                
                calendarHtml += `
                    <div class="calendar-day">
                        <div class="calendar-day-header">${day}</div>
                `;
                
                dayEvents.forEach(event => {
                    const eventClass = event.type.includes('Service') ? 'service' : 
                                      event.type.includes('Prayer') ? 'prayer' : '';
                    calendarHtml += `
                        <div class="calendar-event ${eventClass}" onclick="viewEvent(${event.id})">
                            ${event.time ? event.time.substring(0, 5) + ' ' : ''}${event.name}
                        </div>
                    `;
                });
                
                calendarHtml += `</div>`;
            }
            
            calendarGrid.innerHTML = calendarHtml;
            
            // Update upcoming events table
            const upcomingTable = document.getElementById('upcoming-events-table');
            if (upcomingTable) {
                const upcomingEvents = [...state.events]
                    .filter(e => new Date(e.date) >= new Date())
                    .sort((a, b) => new Date(a.date) - new Date(b.date))
                    .slice(0, 5);
                
                if (upcomingEvents.length === 0) {
                    upcomingTable.innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 40px;">
                                <div class="empty-state">
                                    <i class="fas fa-calendar"></i>
                                    <p>No upcoming events</p>
                                </div>
                            </td>
                        </tr>
                    `;
                } else {
                    let html = '';
                    upcomingEvents.forEach(event => {
                        const eventDate = new Date(event.date);
                        const formattedDate = eventDate.toLocaleDateString('en-US', { 
                            weekday: 'short', 
                            month: 'short', 
                            day: 'numeric' 
                        });
                        
                        html += `
                            <tr>
                                <td>${formattedDate}</td>
                                <td>${event.name}</td>
                                <td>${event.time || 'TBD'}</td>
                                <td>${event.location || 'Main Sanctuary'}</td>
                                <td>
                                    <button class="btn btn-outline btn-sm" onclick="viewEvent(${event.id})">View</button>
                                </td>
                            </tr>
                        `;
                    });
                    upcomingTable.innerHTML = html;
                }
            }
        }
        
        // Navigate calendar
        function navigateCalendar(direction) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + direction);
            updateCalendar();
        }
        
        // Update Dashboard
        function updateDashboard() {
            document.getElementById('total-members').textContent = state.members.length;
            document.getElementById('new-visitors').textContent = state.visitors.length;
            document.getElementById('upcoming-events').textContent = state.events.filter(e => new Date(e.date) >= new Date()).length;
            
             
                
          
            // Update recent activity
            const activityTable = document.getElementById('recent-activity');
            if (activityTable) {
                if (state.activities.length === 0) {
                    activityTable.innerHTML = `
                        <tr>
                            <td colspan="4" style="text-align: center; padding: 20px;">
                                <div class="empty-state">
                                    <i class="fas fa-history"></i>
                                    <p>No recent activity</p>
                                </div>
                            </td>
                        </tr>
                    `;
                } else {
                    let html = '';
                    state.activities.slice(0, 5).forEach(activity => {
                        html += `
                            <tr>
                                <td>${activity.date}</td>
                                <td>${activity.activity}</td>
                                <td>${activity.member}</td>
                                <td>${activity.details}</td>
                            </tr>
                        `;
                    });
                    activityTable.innerHTML = html;
                }
            }
            
            // Update notifications count
            const notificationCount = state.notifications.length || 3; // Demo count
            document.getElementById('dashboard-notifications').textContent = notificationCount;
            document.getElementById('notifications-count').textContent = notificationCount;
            document.getElementById('mobile-notifications-count').textContent = notificationCount;
        }
        
        // Update Settings
        function updateSettings() {
            // Populate settings form with saved values from state
            const s = state.churchSettings || {};
            const nameEl = document.getElementById('setting-name');
            const pastorEl = document.getElementById('setting-senior-pastor');
            const addressEl = document.getElementById('setting-address');
            const serviceEl = document.getElementById('setting-service-times');
            const currencyEl = document.getElementById('setting-currency');

            if (nameEl) nameEl.value = s.name || '';
            if (pastorEl) pastorEl.value = s.seniorPastor || '';
            if (addressEl) addressEl.value = s.address || '';
            if (serviceEl) serviceEl.value = s.serviceTimes || '';
            if (currencyEl) currencyEl.value = s.currency || '';
        }
        
        // Save Settings
        function saveSettings() {
            const nameEl = document.getElementById('setting-name');
            const pastorEl = document.getElementById('setting-senior-pastor');
            const addressEl = document.getElementById('setting-address');
            const serviceEl = document.getElementById('setting-service-times');
            const currencyEl = document.getElementById('setting-currency');

            if (!state.churchSettings) state.churchSettings = {};
            if (nameEl) state.churchSettings.name = nameEl.value;
            if (pastorEl) state.churchSettings.seniorPastor = pastorEl.value;
            if (addressEl) state.churchSettings.address = addressEl.value;
            if (serviceEl) state.churchSettings.serviceTimes = serviceEl.value;
            if (currencyEl) state.churchSettings.currency = currencyEl.value;

            saveToLocalStorage();
            showToast('Settings saved locally', 'success');
        }
        
        // Update Notifications
        function updateNotifications() {
            const notificationsList = document.getElementById('notifications-list');
            if (!notificationsList) return;
            
            // Sample notifications
            const notifications = [
            
                {
                    id: 2,
                    type: 'event',
                    title: 'Upcoming Event',
                    message: 'Bible Study tomorrow at 7:00 PM',
                    time: '5 hours ago',
                    unread: true
                },
                {
                    id: 3,
                    type: 'prayer',
                    title: 'Prayer Request',
                    message: 'New prayer request from Sarah Johnson',
                    time: '1 day ago',
                    unread: false
                },
              
            ];
            
            let html = '';
            notifications.forEach(notif => {
                const unreadClass = notif.unread ? 'unread' : '';
                const typeClass = `type-${notif.type}`;
                
                html += `
                    <div class="notification-item ${unreadClass}">
                        <span class="notification-type ${typeClass}">${notif.type}</span>
                        <div class="notification-title">${notif.title}</div>
                        <div class="notification-message">${notif.message}</div>
                        <div class="notification-time">
                            <i class="far fa-clock"></i> ${notif.time}
                        </div>
                        <div class="notification-actions">
                            <button class="btn btn-outline btn-sm" onclick="markNotificationRead(${notif.id})">Mark Read</button>
                            <button class="btn btn-outline btn-sm" onclick="dismissNotification(${notif.id})">Dismiss</button>
                        </div>
                    </div>
                `;
            });
            
            notificationsList.innerHTML = html;
        }
        
        // Toggle notifications panel
        function toggleNotifications() {
            const panel = document.getElementById('notifications-panel');
            panel.classList.toggle('active');
        }
        
        // Mark notification as read
        function markNotificationRead(id) {
            showToast('Notification marked as read', 'success');
        }
        
        // Dismiss notification
        function dismissNotification(id) {
            showToast('Notification dismissed', 'success');
        }
        
        // Update Attendance Reports
        function updateAttendanceReports() {
            const tableBody = document.getElementById('attendance-reports');
            if (!tableBody) return;
            
            if (state.attendance.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px;">
                            <div class="empty-state">
                                <i class="fas fa-church"></i>
                                <p>No attendance data available</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            state.attendance.slice(0, 5).forEach(att => {
                html += `
                    <tr>
                        <td>${formatDate(att.date)}</td>
                        <td>${att.service}</td>
                        <td>${att.count}</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
        }
        
        // Update Outreach Reports
        function updateOutreachReports() {
            const tableBody = document.getElementById('outreach-reports');
            if (!tableBody) return;
            
            // Sample outreach data
            const outreachEvents = [
                {
                    name: 'Community Food Drive',
                    date: '2023-12-15',
                    participants: 12,
                    contacts: 45,
                    followups: 8
                },
                {
                    name: 'Christmas Outreach',
                    date: '2023-12-24',
                    participants: 25,
                    contacts: 120,
                    followups: 15
                }
            ];
            
            let html = '';
            outreachEvents.forEach(event => {
                html += `
                    <tr>
                        <td>${event.name}</td>
                        <td>${formatDate(event.date)}</td>
                        <td>${event.participants}</td>
                        <td>${event.contacts}</td>
                        <td>${event.followups}</td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
        }
        
        // Generate Report
        function generateReport() {
            const reportType = document.getElementById('report-type').value;
            const reportRange = document.getElementById('report-range').value;
            const reportFormat = document.getElementById('report-format').value;
            
            showToast(`Generating ${reportType} report in ${reportFormat} format...`, 'info');
            
            // Simulate report generation
            setTimeout(() => {
                showToast(`Report generated successfully!`, 'success');
            }, 1500);
        }
        
        // Show all activities
        function showAllActivities() {
            document.querySelector('.nav-item[data-section="reports"]').click();
            showToast('View all activities in Reports section', 'info');
        }
        
     
        
        // Open attendance modal
        function openAttendanceModal() {
            const membersList = document.getElementById('attendance-members-list');
            if (!membersList) return;
            
            document.getElementById('attendance-date').valueAsDate = new Date();
            
            let html = '';
            state.members.forEach(member => {
                html += `
                    <div style="margin-bottom: 10px;">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" value="${member.id}">
                            <span>${member.firstName} ${member.lastName}</span>
                            <span style="color: var(--text-gray); font-size: 0.9rem;">(${member.role || 'Member'})</span>
                        </label>
                    </div>
                `;
            });
            
            membersList.innerHTML = html;
            openModal('attendance-modal');
        }
        
       
        
        // ==================== ACTION FUNCTIONS ====================
        
        // Member Actions
        function viewMember(memberId) {
            const member = state.members.find(m => m.id === memberId);
            if (!member) return;
            showViewModal('Member Details', `
                <strong>Name:</strong> ${member.firstName} ${member.lastName}<br>
                <strong>Email:</strong> ${member.email || 'N/A'}<br>
                <strong>Phone:</strong> ${member.phone}<br>
                <strong>Address:</strong> ${member.address || 'N/A'}<br>
                <strong>Date of Birth:</strong> ${formatDate(member.dob)}<br>
                <strong>Join Date:</strong> ${formatDate(member.joinDate)}<br>
                <strong>Role:</strong> ${member.role || 'Member'}<br>
                <strong>Status:</strong> ${member.status}<br>
                <strong>Ministries:</strong> ${(member.ministries || []).join(', ') || 'None'}<br>
                <strong>Notes:</strong> ${member.notes || 'None'}
            `);
        }
        
        function editMember(memberId) {
            const member = state.members.find(m => m.id === memberId);
            if (!member) return;
            // Populate form
            document.getElementById('member-id').value = member.id;
            document.getElementById('member-firstname').value = member.firstName || '';
            document.getElementById('member-lastname').value = member.lastName || '';
            document.getElementById('member-dob').value = member.dob || '';
            document.getElementById('member-gender').value = member.gender || '';
            document.getElementById('member-email').value = member.email || '';
            document.getElementById('member-phone').value = member.phone || '';
            document.getElementById('member-address').value = member.address || '';
            document.getElementById('member-join-date').value = member.joinDate || '';
            document.getElementById('member-baptism').value = member.baptism || '';
            document.getElementById('member-marital').value = member.marital || '';
            document.getElementById('member-role').value = member.role || 'Member';
            const sel = document.getElementById('member-ministries');
            if (sel) {
                Array.from(sel.options).forEach(opt => opt.selected = (member.ministries || []).includes(opt.value));
            }
            document.getElementById('member-notes').value = member.notes || '';
            document.getElementById('member-submit-btn').textContent = 'Update Member';
            openModal('add-member-modal');
        }
        
        function deleteMember(memberId) {
            if (!confirm('Are you sure you want to delete this member?')) return;
            
            const index = state.members.findIndex(m => m.id === memberId);
            if (index !== -1) {
                const memberName = `${state.members[index].firstName} ${state.members[index].lastName}`;
                state.members.splice(index, 1);
                saveToLocalStorage();
                updateMembersTable();
                updateDashboard();
                updateMemberProfiles();
                showToast(`Member ${memberName} deleted`, 'success');
            }
        }
        
        function viewMemberProfile(memberId) {
            const member = state.members.find(m => m.id === memberId);
            if (!member) return;
            
            // Hide ministry view and show profile detail
            document.getElementById('ministry-categories-view').style.display = 'none';
            const profileView = document.getElementById('member-profile-detail-view');
            profileView.style.display = 'block';
            
            // Populate profile data
            document.getElementById('member-profile-avatar').textContent = member.firstName.charAt(0) + member.lastName.charAt(0);
            document.getElementById('member-profile-name').textContent = `${member.firstName} ${member.lastName}`;
            document.getElementById('member-profile-status').className = `status-badge ${member.status === 'Active' ? 'status-active' : 'status-inactive'}`;
            document.getElementById('member-profile-status').textContent = member.status;
            document.getElementById('member-profile-role').textContent = member.role || 'Member';
            document.getElementById('member-profile-role').className = `role-badge role-${member.role?.toLowerCase() || 'member'}`;
            
            // Populate ministries
            const ministriesList = document.getElementById('member-profile-ministries-list');
            if (member.ministries && member.ministries.length > 0) {
                ministriesList.innerHTML = member.ministries.map(m => `<span class="service-tag">${m}</span>`).join('');
            } else {
                ministriesList.innerHTML = '<span class="text-muted">No ministries assigned</span>';
            }
            
            // Populate personal information
            document.getElementById('profile-full-name').textContent = `${member.firstName} ${member.lastName}`;
            document.getElementById('profile-dob').textContent = member.dob ? formatDate(member.dob) : 'Not provided';
            document.getElementById('profile-gender').textContent = member.gender || 'Not specified';
            document.getElementById('profile-marital').textContent = member.marital || 'Not specified';
            document.getElementById('profile-email').textContent = member.email || 'Not provided';
            document.getElementById('profile-phone').textContent = member.phone;
            document.getElementById('profile-address').textContent = member.address || 'Not provided';
            document.getElementById('profile-join-date').textContent = formatDate(member.joinDate);
            
            // Populate spiritual information
            document.getElementById('profile-baptism').textContent = member.baptism ? formatDate(member.baptism) : 'Not recorded';
            document.getElementById('profile-gifts').textContent = 'To be added';
            document.getElementById('profile-prayer-team').textContent = member.ministries?.includes('Prayer Team') ? 'Yes' : 'No';
            document.getElementById('profile-bible-study').textContent = member.ministries?.includes('Bible Study') ? 'Yes' : 'No';
            
            // Populate notes
            document.getElementById('profile-notes').textContent = member.notes || 'No notes';
            
            // Populate documents
            const documentsList = document.getElementById('member-documents-list');
            const memberDocs = state.documents.filter(d => d.uploadedBy === `${member.firstName} ${member.lastName}`);
            
            if (memberDocs.length === 0) {
                documentsList.innerHTML = '<div class="text-muted">No documents found</div>';
            } else {
                let docsHtml = '';
                memberDocs.forEach(doc => {
                    docsHtml += `
                        <div class="document-item">
                            <div class="document-icon"><i class="fas fa-file-alt"></i></div>
                            <div class="document-info">
                                <div class="document-name">${doc.name}</div>
                                <div class="document-meta">${doc.category}  ${doc.size}</div>
                            </div>
                            <div class="document-actions">
                                <button class="btn btn-outline btn-sm" onclick="downloadDocument(${doc.id})"><i class="fas fa-download"></i></button>
                            </div>
                        </div>
                    `;
                });
                documentsList.innerHTML = docsHtml;
            }
            
            // Populate family members (demo - just show other members with same last name)
            const familyList = document.getElementById('family-members');
            const family = state.members.filter(m => 
                m.lastName === member.lastName && m.id !== member.id
            );
            
            if (family.length === 0) {
                familyList.innerHTML = '<div class="text-muted">No family members found</div>';
            } else {
                let familyHtml = '';
                family.forEach(f => {
                    familyHtml += `
                        <div class="member-card" style="margin-bottom: 10px;" onclick="viewMemberProfile(${f.id})">
                            <div class="member-card-header">
                                <div class="member-card-avatar" style="width: 40px; height: 40px; font-size: 1rem;">${f.firstName.charAt(0)}${f.lastName.charAt(0)}</div>
                                <div class="member-card-info">
                                    <div class="member-card-name">${f.firstName} ${f.lastName}</div>
                                    <div class="member-card-role">${f.role || 'Member'}</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                familyList.innerHTML = familyHtml;
            }
        }
        
        // Back to profiles
        document.getElementById('back-to-profiles')?.addEventListener('click', function() {
            document.getElementById('member-profile-detail-view').style.display = 'none';
            document.getElementById('ministry-categories-view').style.display = 'block';
        });
        
        // Visitor Actions
        function viewVisitor(visitorId) {
            const visitor = state.visitors.find(v => v.id === visitorId);
            if (!visitor) return;
            showViewModal('Visitor Details', `
                <strong>Name:</strong> ${visitor.firstName} ${visitor.lastName}<br>
                <strong>Email:</strong> ${visitor.email || 'N/A'}<br>
                <strong>Phone:</strong> ${visitor.phone || 'N/A'}<br>
                <strong>Visit Date:</strong> ${formatDate(visitor.visitDate)}<br>
                <strong>Service:</strong> ${visitor.service || 'N/A'}<br>
                <strong>Interests:</strong> ${(visitor.interests || []).join(', ') || 'None'}<br>
                <strong>Follow-up:</strong> ${visitor.followUp}<br>
                <strong>Status:</strong> ${visitor.status}<br>
                <strong>Notes:</strong> ${visitor.notes || 'None'}
            `);
        }
        
        function editVisitor(visitorId) {
            const visitor = state.visitors.find(v => v.id === visitorId);
            if (!visitor) return;
            document.getElementById('visitor-id').value = visitor.id;
            document.getElementById('visitor-firstname').value = visitor.firstName || '';
            document.getElementById('visitor-lastname').value = visitor.lastName || '';
            document.getElementById('visitor-email').value = visitor.email || '';
            document.getElementById('visitor-phone').value = visitor.phone || '';
            document.getElementById('visitor-visit-date').value = visitor.visitDate || '';
            document.getElementById('visitor-service').value = visitor.service || '';
            const sel = document.getElementById('visitor-interests');
            if (sel) Array.from(sel.options).forEach(opt => opt.selected = (visitor.interests || []).includes(opt.value));
            document.getElementById('visitor-notes').value = visitor.notes || '';
            document.getElementById('visitor-submit-btn').textContent = 'Update Visitor';
            openModal('add-visitor-modal');
        }
        
        function deleteVisitor(visitorId) {
            if (!confirm('Are you sure you want to delete this visitor?')) return;
            
            const index = state.visitors.findIndex(v => v.id === visitorId);
            if (index !== -1) {
                const visitorName = `${state.visitors[index].firstName} ${state.visitors[index].lastName}`;
                state.visitors.splice(index, 1);
                saveToLocalStorage();
                updateVisitorsTable();
                showToast(`Visitor ${visitorName} deleted`, 'success');
            }
        }
        
        // Prayer Actions
        function viewPrayer(prayerId) {
            const prayer = state.prayerRequests.find(p => p.id === prayerId);
            if (!prayer) return;
            showViewModal('Prayer Request', `
                <strong>From:</strong> ${prayer.name}<br>
                <strong>Date:</strong> ${formatDate(prayer.date)}<br>
                <strong>Category:</strong> ${prayer.category}<br>
                <strong>Privacy:</strong> ${prayer.privacy}<br>
                <strong>Request:</strong><br>${prayer.request}<br>
                <strong>Status:</strong> ${prayer.answered ? 'Answered' : 'Active'}<br>
                ${prayer.answered ? `<strong>Answered on:</strong> ${formatDate(prayer.answered_date)}` : ''}
            `);
        }

        function editPrayer(prayerId) {
            const prayer = state.prayerRequests.find(p => p.id === prayerId);
            if (!prayer) return;
            document.getElementById('prayer-id').value = prayer.id;
            document.getElementById('prayer-name').value = prayer.name || '';
            document.getElementById('prayer-date').value = prayer.date || '';
            document.getElementById('prayer-request').value = prayer.request || '';
            document.getElementById('prayer-category').value = prayer.category || '';
            document.getElementById('prayer-private').value = prayer.privacy || '';
            document.getElementById('prayer-submit-btn').textContent = 'Update Prayer Request';
            openModal('add-prayer-modal');
        }
        
        function markPrayerAnswered(prayerId) {
            const prayer = state.prayerRequests.find(p => p.id === prayerId);
            if (prayer) {
                prayer.answered = true;
                prayer.answered_date = new Date().toISOString().split('T')[0];
                prayer.answered_by = currentUser?.displayName || 'System';
                saveToLocalStorage();
                updatePrayerTable();
                showToast('Prayer request marked as answered!', 'success');
            }
        }
        
        function deletePrayer(prayerId) {
            if (!confirm('Are you sure you want to delete this prayer request?')) return;
            
            const index = state.prayerRequests.findIndex(p => p.id === prayerId);
            if (index !== -1) {
                state.prayerRequests.splice(index, 1);
                saveToLocalStorage();
                updatePrayerTable();
                showToast('Prayer request deleted', 'success');
            }
        }
        
        // Event Actions
        function viewEvent(eventId) {
            const event = state.events.find(e => e.id === eventId);
            if (!event) return;
            showViewModal('Event Details', `
                <strong>Name:</strong> ${event.name}<br>
                <strong>Type:</strong> ${event.type}<br>
                <strong>Date:</strong> ${formatDate(event.date)} ${event.time || ''}<br>
                <strong>Location:</strong> ${event.location || 'TBD'}<br>
                <strong>Leader:</strong> ${event.leader || 'TBD'}<br>
                <strong>Description:</strong><br>${event.description}
            `);
        }
        // Generic View Modal
        function showViewModal(title, htmlContent) {
            let modal = document.getElementById('view-modal');
            if (!modal) {
                modal = document.createElement('div');
                modal.className = 'modal';
                modal.id = 'view-modal';
                modal.innerHTML = `
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 id="view-modal-title"></h2>
                            <button class="modal-close" id="close-view-modal">&times;</button>
                        </div>
                        <div id="view-modal-body" style="font-size:1.05rem;line-height:1.7;"></div>
                    </div>
                `;
                document.body.appendChild(modal);
                document.getElementById('close-view-modal').onclick = () => {
                    modal.style.display = 'none';
                };
            }
            document.getElementById('view-modal-title').innerHTML = title;
            document.getElementById('view-modal-body').innerHTML = htmlContent;
            modal.style.display = 'flex';
        }
        
        function editEvent(eventId) {
            const event = state.events.find(e => e.id === eventId);
            if (!event) return;
            document.getElementById('event-id').value = event.id;
            document.getElementById('event-name').value = event.name || '';
            document.getElementById('event-type').value = event.type || '';
            document.getElementById('event-date').value = event.date || '';
            document.getElementById('event-time').value = event.time || '';
            document.getElementById('event-location').value = event.location || '';
            document.getElementById('event-leader').value = event.leader || '';
            document.getElementById('event-description').value = event.description || '';
            document.getElementById('event-submit-btn').textContent = 'Update Event';
            openModal('create-event-modal');
        }
        
        function deleteEvent(eventId) {
            if (!confirm('Are you sure you want to delete this event?')) return;
            
            const index = state.events.findIndex(e => e.id === eventId);
            if (index !== -1) {
                const eventName = state.events[index].name;
                state.events.splice(index, 1);
                saveToLocalStorage();
                updateEventsGrid();
                updateCalendar();
                showToast(`Event "${eventName}" deleted`, 'success');
            }
        }
        
        // Ministry Actions
        function viewMinistry(ministryId) {
            const ministry = state.ministries.find(m => m.id === ministryId);
            if (!ministry) return;
            
            const members = state.members.filter(m => 
                m.ministries && m.ministries.includes(ministry.name)
            );
            
            alert(`Ministry: ${ministry.name}\n` +
                  `Leader: ${ministry.leader || 'TBD'}\n` +
                  `Members: ${members.length}\n` +
                  `Meeting: ${ministry.meetingDay || 'TBD'} ${ministry.meetingTime || ''}\n` +
                  `Location: ${ministry.location || 'TBD'}\n\n` +
                  `Members:\n${members.map(m => `- ${m.firstName} ${m.lastName}`).join('\n')}`);
        }
        
        function editMinistry(ministryId) {
            const ministry = state.ministries.find(m => m.id === ministryId);
            if (!ministry) return;
            document.getElementById('ministry-id').value = ministry.id;
            document.getElementById('ministry-name').value = ministry.name || '';
            document.getElementById('ministry-leader').value = ministry.leader || '';
            document.getElementById('ministry-meeting-day').value = ministry.meetingDay || '';
            document.getElementById('ministry-meeting-time').value = ministry.meetingTime || '';
            document.getElementById('ministry-location').value = ministry.location || '';
            document.getElementById('ministry-description').value = ministry.description || '';
            document.getElementById('ministry-submit-btn').textContent = 'Update Ministry';
            openModal('add-ministry-modal');
        }
        
        function deleteMinistry(ministryId) {
            if (!confirm('Are you sure you want to delete this ministry?')) return;
            
            const index = state.ministries.findIndex(m => m.id === ministryId);
            if (index !== -1) {
                const ministryName = state.ministries[index].name;
                state.ministries.splice(index, 1);
                saveToLocalStorage();
                updateMinistriesGrid();
                showToast(`Ministry "${ministryName}" deleted`, 'success');
            }
        }
        
        // Document Actions
        function editDocument(docId) {
            const doc = state.documents.find(d => d.id === docId);
            if (!doc) return;
            document.getElementById('document-id').value = doc.id;
            document.getElementById('document-name').value = doc.name || '';
            document.getElementById('document-category').value = doc.category || '';
            document.getElementById('document-description').value = doc.description || '';
            document.getElementById('document-submit-btn').textContent = 'Update Document';
            openModal('upload-document-modal');
        }
        function downloadDocument(docId) {
            const doc = state.documents.find(d => d.id === docId);
            if (doc) {
                showToast(`Downloading ${doc.name}...`, 'success');
                // In a real app, this would trigger file download
            }
        }
        
        function deleteDocument(docId) {
            if (!confirm('Are you sure you want to delete this document?')) return;
            
            const index = state.documents.findIndex(d => d.id === docId);
            if (index !== -1) {
                const docName = state.documents[index].name;
                state.documents.splice(index, 1);
                saveToLocalStorage();
                updateDocumentsTable();
                showToast(`Document "${docName}" deleted`, 'success');
            }
        }
        
      
        
        // Make functions available globally
        window.viewMember = viewMember;
        window.editMember = editMember;
        window.deleteMember = deleteMember;
        window.viewMemberProfile = viewMemberProfile;
        window.viewVisitor = viewVisitor;
        window.editVisitor = editVisitor;
        window.deleteVisitor = deleteVisitor;
        window.viewPrayer = viewPrayer;
        window.editPrayer = editPrayer;
        window.markPrayerAnswered = markPrayerAnswered;
        window.deletePrayer = deletePrayer;
        window.viewEvent = viewEvent;
        window.editEvent = editEvent;
        window.deleteEvent = deleteEvent;
        window.viewMinistry = viewMinistry;
        window.editMinistry = editMinistry;
        window.deleteMinistry = deleteMinistry;
        window.downloadDocument = downloadDocument;
        window.editDocument = editDocument;
        window.deleteDocument = deleteDocument;
       
        window.printReceipt = printReceipt;
        window.filterByMinistry = filterByMinistry;
        window.filterByRole = filterByRole;
        window.markNotificationRead = markNotificationRead;
        window.viewUser = viewUser;
        window.editUser = editUser;
        window.deleteUser = deleteUser;
        window.dismissNotification = dismissNotification;
       
    </script>
</body>
</html>
